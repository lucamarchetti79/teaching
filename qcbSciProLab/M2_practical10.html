

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module 2, Practical 10 &mdash; QCB Scientific Programming Lab</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/js/jupman.js"></script>
        <script type="text/javascript" src="_static/js/pytutor-embed.bundle.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/jupman.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/jupman-web.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="toc-page.html" class="icon icon-home"> QCB Scientific Programming Lab
          

          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Scientific Programming for QCB</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#General-Info">General Info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#Timetable-and-lecture-rooms">Timetable and lecture rooms</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Zoom-links">Zoom links</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Equipment">Equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical1.html">Module 1, Practical 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Setting-up-the-environment">Setting up the environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#Linux-on-windows">Linux on windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#A-dual-boot-system">A dual boot system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Our-toolbox">Our toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Installing-Python3-in-Linux">Installing Python3 in Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Installing-Python3-in-Windows/Mac">Installing Python3 in Windows/Mac</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#OPTION-1:">OPTION 1:</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#OPTION-2-(easier):">OPTION 2 (easier):</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#The-console">The console</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Visual-Studio-Code">Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#The-debugger">The debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#A-quick-Jupyter-primer-(just-for-your-information,-skip-if-not-interested)">A quick Jupyter primer (just for your information, skip if not interested)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#Installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical2.html">Module 1, Practical 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Objects">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Numeric-types">Numeric types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Integers">Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Booleans">Booleans</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Real-numbers">Real numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Strings">Strings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Methods-for-the-str-object">Methods for the str object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical3.html">Module 1, Practical 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Lists">Lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#Operators-for-lists">Operators for lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#Methods-of-the-class-list">Methods of the class list</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#From-strings-to-lists,-the-split-method">From strings to lists, the <code class="docutils literal notranslate"><span class="pre">split</span></code> method</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#And-back-to-strings-with-the-join-method">And back to strings with the <code class="docutils literal notranslate"><span class="pre">join</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Tuples">Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Introduction-to-sets">Introduction to sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical4.html">Module 1, Practical 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Execution-flow">Execution flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Conditionals">Conditionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#The-basic-if---else-statement">The basic <em>if - else</em> statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#The-if---elif---else-statement">The <em>if - elif - else</em> statement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Loops">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#For-loop">For loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#Looping-over-a-range">Looping over a range</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#Nested-for-loops">Nested for loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#While-loops">While loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical5.html">Module 1, Practical 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#More-on-loops">More on loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Ternary-operator">Ternary operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Break-and-continue">Break and continue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="M1_practical5.html#Continue-statement">Continue statement</a></li>
<li class="toctree-l4"><a class="reference internal" href="M1_practical5.html#Break-statement">Break statement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#List-comprehension">List comprehension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#Dictionaries">Dictionaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Functions-working-on-dictionaries">Functions working on dictionaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Dictionary-methods">Dictionary methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="toc.html"> </a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc-page.html">QCB Scientific Programming Lab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          


    <div id='jupman-langs'></div>

    <!-- SMALL TEMPLATE FOR LANGUAGES (VERY CUSTOM FOR softpython.org !!)
    <script>
    var hn = window.location.hostname;
    var pn = window.location.pathname;

    if (hn.includes('softpython.org')){
        JUPMAN_LANG = hn.slice(0,window.location.hostname.indexOf('.'));
    } else if (pn.includes('/_build/html')){
        var pos = pn.indexOf('/_build/html');
        JUPMAN_LANG = pn.slice(pos-2, pos);
    } else {
        JUPMAN_LANG = 'en';
    }
    console.log('JUPMAN_LANG=',JUPMAN_LANG);
    </script>
    -->
    
    
     <!-- <li> <h2 style="background-color:red; color:yellow">WARNING! THIS VERSION IS OLD !  <br/>
    <a style=" text-decoration: underline;" href="https://jupman.readthedocs.io/en/latest">GOT TO LATEST VERSION</a></li>
 </h2></li>-->
    <!-- Commented because doesn't work with sections,
         see https://github.com/DavidLeoni/jupman/issues/39
    <li><a href="toc-page.html">Docs</a> &raquo;</li>
    
    <li>Module 2, Practical 10</li>
    -->

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Module-2,-Practical-10">
<h1>Module 2, Practical 10<a class="headerlink" href="#Module-2,-Practical-10" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">In this practical we will experiment with <strong>programming paradigms</strong>.</div>
<div class="line">In particular, we will briefly introduce the <strong>dynamic programming</strong> and <strong>greedy</strong> programming techniques.</div>
</div>
<div class="section" id="Dynamic-programming">
<h2>Dynamic programming<a class="headerlink" href="#Dynamic-programming" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Dynamic programming is a strategy to optimize recursive algorithms.</div>
<div class="line">Every time we find an algorithm solving a bigger problem by <em>repetitive recursive calls</em> on smaller subproblems, we can optimize it by using <strong>dynamic programming</strong>.</div>
<div class="line">The key idea is simply to <em>store</em> in a table the solution of the subproblems and obtain the result of these subproblems by performing a table lookup.</div>
</div>
<p>Two approaches exist:</p>
<ol class="arabic simple">
<li><p><strong>Top-down</strong>: solve the problem by breaking it down in smaller subproblems. If the subproblem has already been solved, then the answer has already been saved somewhere. If it has not already been solved, compute a solution and store it. This method is called <strong>memoization</strong>;</p></li>
<li><p><strong>Bottom-up</strong>: solve the problem by starting from the most trivial subproblems, going up until the complete problem has been solved. Smaller subproblems are guaranteed to be solved before bigger ones. This method is called <strong>dynamic programming</strong>.</p></li>
</ol>
<p>Consider the classic example of the computation of Fibonacci numbers:</p>
<div class="math notranslate nohighlight">
\[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, ...\]</div>
<p>which can be computed by the following recursive formula:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F(n)=\left\{
                \begin{array}{ll}
                  n &amp; if\ n == 0\ or\ n\ == 1\\
                  F(n-1)+ F(n-2) &amp; if\ n &gt; 1
                \end{array}
              \right.\end{split}\]</div>
<p>This problem can be solved with the following recursive code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fib(</span><span class="si">{}</span><span class="s2">)= </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fib(</span><span class="si">{}</span><span class="s2">)= </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fib</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    <span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fib(0)= 0
Fib(1)= 1
Fib(2)= 1
Fib(3)= 2
Fib(4)= 3
Fib(5)= 5
Fib(6)= 8
Fib(7)= 13
Fib(8)= 21
Fib(9)= 34
Fib(10)= 55
Fib(11)= 89
Fib(12)= 144
Fib(13)= 233
Fib(14)= 377
Fib(15)= 610
Fib(16)= 987
Fib(17)= 1597
Fib(18)= 2584
Fib(19)= 4181

Fib(35)= 9227465
It took 5.47s

Fib(36)= 14930352
It took 8.76s

Fib(37)= 24157817
It took 12.93s

Fib(38)= 39088169
It took 21.43s

Fib(39)= 63245986
It took 33.32s
</pre></div></div>
</div>
<p>Although simple to code, the recursive solution performs some steps multiple times, as shown by the following recursion tree (for example f(3) is computed 5 times):</p>
<img alt="_images/tree.png" src="_images/tree.png" />
<p>We can use dynamic programming to avoid computing over and over again the same values:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">fib_dp</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">fib</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">fib</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fib</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fib(</span><span class="si">{}</span><span class="s2">)= </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fib_dp</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">38</span><span class="p">):</span>
    <span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fib(</span><span class="si">{}</span><span class="s2">)= </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fib_dp</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    <span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span> <span class="o">-</span> <span class="n">start_t</span><span class="p">))</span>

<span class="c1">#we can even do:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1003</span><span class="p">):</span>
    <span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Fib(</span><span class="si">{}</span><span class="s2">)= </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">fib_dp</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
    <span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span> <span class="o">-</span> <span class="n">start_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fib(0)= 0
Fib(1)= 0
Fib(2)= 1
Fib(3)= 2
Fib(4)= 3
Fib(5)= 5
Fib(6)= 8
Fib(7)= 13
Fib(8)= 21
Fib(9)= 34
Fib(10)= 55
Fib(11)= 89
Fib(12)= 144
Fib(13)= 233
Fib(14)= 377
Fib(15)= 610
Fib(16)= 987
Fib(17)= 1597
Fib(18)= 2584
Fib(19)= 4181

Fib(35)= 9227465
It took 0.00s

Fib(36)= 14930352
It took 0.00s

Fib(37)= 24157817
It took 0.00s

Fib(1000)= 43466557686937456435688527675040625802564660517371780402481729089536555417949051890403879840079255169295922593080322634775209689623239873322471161642996440906533187938298969649928516003704476137795166849228875
It took 0.00s

Fib(1001)= 70330367711422815821835254877183549770181269836358732742604905087154537118196933579742249494562611733487750449241765991088186363265450223647106012053374121273867339111198139373125598767690091902245245323403501
It took 0.00s

Fib(1002)= 113796925398360272257523782552224175572745930353730513145086634176691092536145985470146129334641866902783673042322088625863396052888690096969577173696370562180400527049497109023054114771394568040040412172632376
It took 0.00s
</pre></div></div>
</div>
<p>In the latter case we accumulated partial results in a list and re-used them when needed. Consider the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">fib_dp</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">fib</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">fib</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">fib</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fib</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">fib</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>


<span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15000</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">fib_dp</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
It took 46.38s
</pre></div></div>
</div>
<p>In this case we repeated the computations several times anyway and had to recompute the solution all the time, which is a little bit of a waste of time. If we are not concerned about using more space we could modify the code in such a way to update a list and return the whole list, ready for a next iteration:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">fib_dpV2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">fibList</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fibList</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fibList</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fibList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fibList</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">fibList</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
            <span class="c1"># compute all the fibonacci values required to reach fib(n) and store them in the list...</span>
            <span class="n">fibList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fibList</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">fibList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fibList</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">myFibL</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">15001</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">fib_dpV2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">myFibL</span><span class="p">)</span>
<span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fibonacci(15000) : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myFibL</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fibonacci 0..20: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myFibL</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fibonacci(15000) : 180356212817232358527136269558393274270479577287959770214783776455882580176808282935116449287253001675278567205597341664270703993136851989859494809191272208168671602010135312495296553662790352582033423080689757992520655785610316941531173588408998619812807392167094455165363355259485592278979388870298110870050912172411703995878726547708126588747557108886477742159519675726841476567233617069303168933729769224839193682942110633367322841686836744207977400786184404283243942571683714924012584054120950619420879245008334171878098209414559267738476048405512373264705915648256421029922854826089454770481653365776765021018110912210918296748113016817314353185049893148191072970004722127877580853512230597663125482412037507790122452840808247238862266940374952733301348535189028427982115508256085629078838285854519748549211253115363900979738960948772589014559911367102564396479380119671836661458473444680552841046388920629103926658110037230386547506816712866616340383491227279709660200771238944743897531289959511150305531873160607872566720751381188951153762201432960669039121243742888978686571778654570582578356003787537920689451735958244288072349086881269456351988300299442324421142440230312335818179554507414851349917896307630882698214864014344956780348499120670367075038565963319741348415248138037342603113034434198363994519415494026021710622105031596662576344941382709460665227123428132640271682951472209368453748754510035741638613590279538796566181871895713339174456728394471357415996934436202565485732749272347348991793493320243181956465786389970599533658454386144770652584880176519203467064567384636418219255416950945755037995377546451320680325530900980211314010182766809827492194845387482751225482662997765661866262382112219008183345652570682633899549560294736097218086788785294700336993482784319083980440026327099112563241621005721911339313568395785607613027063516725870186041444932874242502339316433484868302535616417673857358757000197098734066555060275659441540730179880840068680711039092402469979537402038522869532858210224421954879125281803617171486680299882175622463954938841161683824017764172124148438928242788323301450705633955505182591808014745581257657569980476219657313856171171041106956687416108450931365450698373196534957320986723454445945232416845732305494189207716358085853199984634824143123729540264742981573020172237026058046740201545250287662018382140146169998065636288937211877886621661690578651489040221004254744005525689460483194423394923570500857169107685204978377809144999120496376447004389621794981767672901579794816635242858841182877011991980777649470507584848234893126914722042071134658473351945026030226538176505680011883028482299815999170838410236573499975247752075137709072936793331605370102620992579010729955042839150039536988476316814658001111401786786920802580057225089821741914525126541381743907218686111921778056456742847181643346546263899570276608898254139702386798819800561168979805761661085945938400171610214159378775050985949240013649311708619468421748433514761538254173535727874452760668054213182096783214642043675647412439936425441952983174011449159555969819986536279264099966926245798558475510001
It took 0.02s
Fibonacci 0..20: [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, 2584, 4181]
</pre></div></div>
</div>
<div class="section" id="Excercise">
<h3>Excercise<a class="headerlink" href="#Excercise" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Catalan numbers (info <a class="reference external" href="https://en.wikipedia.org/wiki/Catalan_number">here</a>) are defined by the following recurrence equation:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}C(n)=\left\{
                \begin{array}{ll}
                  1 &amp; if\ n &lt;=1 \\
                  \sum_{i=0}^{n-1} C(i) C(n-1 -i)&amp; if\ n &gt; 1
                \end{array}
              \right.\end{split}\]</div>
<p>the first few values are reported below:</p>
<p><span class="math notranslate nohighlight">\(1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786,\)</span> <span class="math notranslate nohighlight">\(208012, 742900, 2674440, 9694845, 35357670, 129644790,\)</span> <span class="math notranslate nohighlight">\(477638700, 1767263190, 6564120420, 24466267020, 91482563640, ...\)</span></p>
<ol class="loweralpha simple">
<li><p>Write a recursive function <code class="docutils literal notranslate"><span class="pre">recCatalan(n)</span></code> to compute the n-th catalan number;</p></li>
<li><p>Write a dynamic programming function <code class="docutils literal notranslate"><span class="pre">dpCatalan(n)</span></code> to compute the n-th catalan number.</p></li>
</ol>
<p>Test your code with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>catN = []
for i in range(0,15):
    catN.append(recCatalan(i))

print(&quot;First 15 catalan numbers:&quot;)
print(catN)
</pre></div>
</div>
<p>Finally, check how long it takes to compute the 20th catalan number with the recursive algorithm and with the dynamic programming one.</p>
<div class="tggle" onclick="toggleVisibility(&#39;Ex1&#39;);"><p>Show/Hide Solution</p>
</div><div id="Ex1" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">recCatalan</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cat</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">cat</span> <span class="o">+=</span> <span class="n">recCatalan</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">recCatalan</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cat</span>

<span class="k">def</span> <span class="nf">dpCatalan</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">catNums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">catNums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
                <span class="n">catNums</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">catNums</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">catNums</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">catNums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>


<span class="n">catN</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">catN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recCatalan</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 15 catalan numbers:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catN</span><span class="p">)</span>

<span class="n">catN</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="c1">#for i in range(0,19):</span>
<span class="c1">#    catN.append(recCatalan(i))</span>
<span class="n">catN</span> <span class="o">=</span> <span class="n">recCatalan</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;20th catalan number:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catN</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>


<span class="n">catN</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 15 catalan numbers (dyn.p):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">catN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dpCatalan</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catN</span><span class="p">)</span>
<span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>

<span class="n">catN</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">start_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">catN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dpCatalan</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="n">end_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 30 catalan numbers (dyn.p):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catN</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It took </span><span class="si">{:.2f}</span><span class="s2">s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">end_t</span><span class="o">-</span><span class="n">start_t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First 15 catalan numbers:
[1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440]
20th catalan number:
6564120420
It took 463.08s
First 15 catalan numbers (dyn.p):
[1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440]
First 30 catalan numbers (dyn.p):
[1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452, 18367353072152, 69533550916004, 263747951750360, 1002242216651368]
It took 0.00s
</pre></div></div>
</div>
<p>Download the complete source file: <a class="reference external" href="programming_paradigms/catalan.py">catalan.py</a></p>
</div></div>
</div>
<div class="section" id="Finding-(the-optimal)-overlaps-among-DNA-strings">
<h2>Finding (the optimal) overlaps among DNA strings<a class="headerlink" href="#Finding-(the-optimal)-overlaps-among-DNA-strings" title="Permalink to this headline">¶</a></h2>
<p>As another example of dynamic programming, let’s consider the problem of finding overlaps between two reads. This is quite an important problem for genome assembly and since sequencers nowadays produce several thousands/millions of (long) reads, devising efficient algorithms to find overlaps between two reads is quite important in this field.</p>
<p>Note in fact that, given a set of <span class="math notranslate nohighlight">\(N\)</span> reads, assembly algorithms need to find the best overlaps among all of them, which means testing <span class="math notranslate nohighlight">\(N * (N-1)\)</span> pairs.</p>
<p>Given two reads <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> the optimal overlap among them is the longest suffix of <span class="math notranslate nohighlight">\(X\)</span> that matches (possibly with some mismatches) a prefix of <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<p>Example:</p>
<img alt="_images/overlap.png" src="_images/overlap.png" />
<p>We are basically interested in finding the best alignment of a suffix of <span class="math notranslate nohighlight">\(X\)</span> on a prefix of <span class="math notranslate nohighlight">\(Y\)</span> taking possible errors in consideration.</p>
<p>First of all we need to define a <em>score function</em> that given two bases (among the possible 4: A,T,C,G and the gap “-”), returns a score reporting the goodness of the match of the two bases:</p>
<img alt="_images/score.png" src="_images/score.png" />
<p>which <strong>basically penalizes mismatches</strong> by giving them a high score. Our aim would be to find the longest string with the lowest score starting from the end of the first string backwards.</p>
<p>Given the two strings <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, the so called <strong>global alignment recurrence</strong> is the following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A[i,j]=min \left\{
                \begin{array}{l}
                  A[i - 1, j] + score(x[i - 1], &quot;-&quot;)\\
                  A[i, j - 1] + score(&quot;-&quot;, y[j - 1])\\
                  A[i - 1 , j - 1] + score(x[i - 1], y[j - 1])
                \end{array}
              \right.\end{split}\]</div>
<p>The first row of the matrix corresponds to “-” in <span class="math notranslate nohighlight">\(X\)</span> and all elements are initialized to <span class="math notranslate nohighlight">\(\infty\)</span>, while the first column corresponds to a “-” in <span class="math notranslate nohighlight">\(Y\)</span> and all elements are initialized to 0.</p>
<p>Intuitively, the first row represents the case in which we want to match a base in <span class="math notranslate nohighlight">\(X\)</span> with a gap “-” in <span class="math notranslate nohighlight">\(Y\)</span> (and therefore we do not use characters of <span class="math notranslate nohighlight">\(Y\)</span>), in the second row we match a base in <span class="math notranslate nohighlight">\(Y\)</span> with a gap “-” in <span class="math notranslate nohighlight">\(X\)</span> and in the third we have a base from both.</p>
<p>We can impose a minimum length <span class="math notranslate nohighlight">\(N\)</span> of the overlap by setting to infinity the last <span class="math notranslate nohighlight">\(N-1\)</span> elements of the first column and setting to infinity (at the end) the first <span class="math notranslate nohighlight">\(N\)</span> columns of the last row.</p>
<p>The output of this procedure is a matrix like (where the highlighted elements are actually the overlap):</p>
<img alt="_images/ovlpmat.png" src="_images/ovlpmat.png" />
<p>For now we will see the code that builds the matrix. Obtaining the actual overlap will involve travelling back up from the last row of the matrix</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">mat</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">computeMatrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="c1"># + 1 is for leading &quot;-&quot;</span>
    <span class="n">x_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">y_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#initialize first column to 0 and first row to infinite</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x_len</span> <span class="o">-</span> <span class="n">minLen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">minLen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="c1"># compute the rest of the score matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x_len</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">y_len</span><span class="p">):</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">#print(&quot;i,j: {},{}&quot;.format(i,j))</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">minLen</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">minLen</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="k">def</span> <span class="nf">plotMatrix</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">X</span>
    <span class="n">outStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">-&quot;</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Mat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>


<span class="n">X</span> <span class="o">=</span> <span class="s2">&quot;CTCGGCCCTAGG&quot;</span>
<span class="n">Y</span> <span class="o">=</span> <span class="s2">&quot;GGCTCTAGGCCC&quot;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">minLen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The overlap matrix:&quot;</span><span class="p">)</span>
<span class="n">plotMatrix</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X1</span> <span class="o">=</span> <span class="s2">&quot;AATATACATAC&quot;</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="s2">&quot;TACGTACTTA&quot;</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The overlap matrix:&quot;</span><span class="p">)</span>
<span class="n">plotMatrix</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X3</span> <span class="o">=</span> <span class="s2">&quot;ACACGGATT&quot;</span>
<span class="n">Y3</span> <span class="o">=</span> <span class="s2">&quot;CGGTATT&quot;</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The overlap matrix:&quot;</span><span class="p">)</span>
<span class="n">plotMatrix</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CTCGGCCCTAGG
GGCTCTAGGCCC
The overlap matrix:
        -       G       G       C       T       C       T       A       G       G       C       C       C
-       0       inf     inf     inf     inf     inf     inf     inf     inf     inf     inf     inf     inf
C       0       1       2       3       4       5       6       7       8       9       10      11      12
T       0       1       2       3       4       5       6       7       8       9       10      11      12
C       0       1       2       3       4       5       6       7       8       9       10      11      12
G       0       1       2       3       4       5       6       7       8       9       10      11      12
G       0       1       2       3       4       5       6       7       8       9       10      11      12
C       0       1       2       3       4       5       6       7       8       9       10      11      12
C       0       1       2       3       4       5       6       7       8       9       10      11      12
C       0       1       2       3       4       5       6       7       8       9       10      11      12
T       inf     1       2       3       4       5       6       7       8       9       10      11      12
A       inf     2       2       3       4       5       6       7       8       9       10      11      12
G       inf     3       3       3       4       5       6       7       8       9       10      11      12
G       inf     inf     inf     inf     inf     5       6       7       8       9       10      11      12


AATATACATAC
TACGTACTTA
The overlap matrix:
        -       T       A       C       G       T       A       C       T       T       A
-       0       inf     inf     inf     inf     inf     inf     inf     inf     inf     inf
A       0       1       2       3       4       5       6       7       8       9       10
A       0       1       2       3       4       5       6       7       8       9       10
T       0       1       2       3       4       5       6       7       8       9       10
A       0       1       2       3       4       5       6       7       8       9       10
T       0       1       2       3       4       5       6       7       8       9       10
A       0       1       2       3       4       5       6       7       8       9       10
C       0       1       2       3       4       5       6       7       8       9       10
A       0       1       2       3       4       5       6       7       8       9       10
T       inf     1       2       3       4       5       6       7       8       9       10
A       inf     2       2       3       4       5       6       7       8       9       10
C       inf     inf     inf     inf     4       5       6       7       8       9       10


ACACGGATT
CGGTATT
The overlap matrix:
        -       C       G       G       T       A       T       T
-       0       inf     inf     inf     inf     inf     inf     inf
A       0       1       2       3       4       5       6       7
C       0       1       2       3       4       5       6       7
A       0       1       2       3       4       5       6       7
C       0       1       2       3       4       5       6       7
G       0       1       2       3       4       5       6       7
G       0       1       2       3       4       5       6       7
A       0       1       2       3       4       5       6       7
T       inf     1       2       3       4       5       6       7
T       inf     inf     inf     3       4       5       6       7
</pre></div></div>
</div>
<p>Download the complete source file: <a class="reference external" href="programming_paradigms/computeMatrixScore.py">computeMatrixScore.py</a></p>
<div class="section" id="Exercise">
<h3>Exercise<a class="headerlink" href="#Exercise" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="2">
<li><p>Implement the following method:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">getOverlap(Mat,</span> <span class="pre">X,Y)</span></code> where Mat is the matrix computed with <code class="docutils literal notranslate"><span class="pre">computeMatrix</span></code>, <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> are the two strings. The function should:</p>
<ul>
<li><p>find the rightmost minimum in the last row of the matrix;</p></li>
<li><p>back track through the matrix moving on the smallest of the neighboring positions (i.e. from A[i,j] move to min(A[i-1,j], A[i-1,j-1], A[i, j-1]) updating the overlap string accordingly. For example, the following matrix:</p></li>
</ul>
</li>
</ul>
<img alt="_images/ovlp_small.png" src="_images/ovlp_small.png" />
<p>should produce the overlap:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{r} \hline
CGGTATT\\
ACACGG-ATT\\ \hline
\end{array}\end{split}\]</div>
<p>If needed, feel free to write another method that prints off the overlap.</p>
<p>You can test your methods with the following code:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>X = &quot;CTCGGCCCTAGG&quot;
Y = &quot;GGCTCTAGGCCC&quot;
A = computeMatrix(X,Y,minLen = 5)
print(&quot;The overlap matrix for {} and {}:&quot;.format(X,Y))
plotMatrix(A,X,Y)
(s1,s2,s,e) = getOverlap(A,X,Y)
printAligns(s1,s2,s,e)
print(&quot;\n&quot;)

X1 = &quot;AATATACATAC&quot;
Y1 = &quot;TACGTACTTA&quot;
B = computeMatrix(X1,Y1, minLen = 4)
print(&quot;The overlap matrix for {} and {}:&quot;.format(X1,Y1))
plotMatrix(B,X1,Y1)
(s1,s2,s,e) = getOverlap(B,X1,Y1)
printAligns(s1,s2,s,e)
print(&quot;\n&quot;)

X2 = &quot;ACACGGATT&quot;
Y2 = &quot;CGGTATT&quot;
C = computeMatrix(X2,Y2, minLen = 3)
(s1,s2,s,e) = getOverlap(C,X2,Y2)
printAligns(s1,s2,s,e)
print(&quot;\n&quot;)

X3 = &quot;GTCAGTCAATCTACTCGGAAACTATACACCG&quot;
Y3 = &quot;AACTATTTCCGTAACACGGATT&quot;
D = computeMatrix(X3,Y3, minLen = 8)
(s1,s2,s,e) = getOverlap(D,X3,Y3)
printAligns(s1,s2,s,e)
print(&quot;\n&quot;)

X4 = &quot;ATCGGTTCGGTGAAGTAA&quot;
Y4 = &quot;CGGTGACGTTACCATATCCAG&quot;
E = computeMatrix(X4,Y4, minLen = 8)
(s1,s2,s,e) = getOverlap(E,X4,Y4)
printAligns(s1,s2,s,e)
</pre></div>
</div>
<div class="tggle" onclick="toggleVisibility(&#39;Ex2&#39;);"><p>Show/Hide Solution</p>
</div><div id="Ex2" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">mat</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>
    <span class="n">mat</span><span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">}</span>

    <span class="k">return</span> <span class="n">mat</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">b</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">computeMatrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="c1"># + 1 is for leading &quot;-&quot;</span>
    <span class="n">x_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">y_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1">#print(X)</span>
    <span class="c1">#print(Y)</span>

    <span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#initialize first column to 0 and first row to infinite</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x_len</span> <span class="o">-</span> <span class="n">minLen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">minLen</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="c1"># compute the rest of the score matrix</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x_len</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">y_len</span><span class="p">):</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
            <span class="n">c2</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">c3</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">#print(&quot;i,j: {},{}&quot;.format(i,j))</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">minLen</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">minLen</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="k">def</span> <span class="nf">plotMatrix</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">X</span>
    <span class="n">outStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">-&quot;</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
        <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Mat</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getOverlap</span><span class="p">(</span><span class="n">Mat</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">X</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">Y</span>

    <span class="c1">#1. find the rightmost minimum of the last row of Mat</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">mInd</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">mInd</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">mInd</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>

    <span class="c1">#2. loop back through the matrix following the minimum values</span>
    <span class="n">S1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">S2</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="c1">#need to count insertions for printing purposes</span>
    <span class="n">emptyY</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#precedence to this if equal</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">v3</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>

        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">v1</span><span class="p">:</span>
            <span class="n">S1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S1</span>
            <span class="n">S2</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S2</span>
            <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">v2</span><span class="p">:</span>
                <span class="n">S1</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">S1</span>
                <span class="n">S2</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S2</span>
                <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">S1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S1</span>
                <span class="n">S2</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">S2</span>
                <span class="c1">#increase end of Y by one</span>
                <span class="n">emptyY</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="c1">#if some parts of the string are left...</span>
    <span class="c1">#this should only be for X</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">S1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S1</span>

    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">S2</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">S2</span>

    <span class="c1">#add the end to S2:</span>
    <span class="n">S2</span> <span class="o">=</span> <span class="n">S2</span> <span class="o">+</span> <span class="n">Y</span><span class="p">[</span><span class="n">mInd</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1">#returns the two strings</span>
    <span class="c1">#and the start and endpoint of</span>
    <span class="c1">#alignment on S2 (removing starting &quot;-&quot;)</span>
    <span class="n">S1</span><span class="o">=</span><span class="n">S1</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">S2</span><span class="o">=</span><span class="n">S2</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">S1</span><span class="p">,</span><span class="n">S2</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">mInd</span> <span class="o">+</span> <span class="n">emptyY</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">printAligns</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Overlap between </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>
    <span class="n">outStr</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="n">S</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
        <span class="n">outStr</span><span class="o">+=</span> <span class="s2">&quot; &quot;</span>
    <span class="n">outStr</span> <span class="o">+=</span>  <span class="n">Y</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>


<span class="n">X</span> <span class="o">=</span> <span class="s2">&quot;CTCGGCCCTAGG&quot;</span>
<span class="n">Y</span> <span class="o">=</span> <span class="s2">&quot;GGCTCTAGGCCC&quot;</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">minLen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The overlap matrix for </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">))</span>
<span class="n">plotMatrix</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">getOverlap</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">printAligns</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X1</span> <span class="o">=</span> <span class="s2">&quot;AATATACATAC&quot;</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="s2">&quot;TACGTACTTA&quot;</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The overlap matrix for </span><span class="si">{}</span><span class="s2"> and </span><span class="si">{}</span><span class="s2">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">))</span>
<span class="n">plotMatrix</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">getOverlap</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">)</span>
<span class="n">printAligns</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X2</span> <span class="o">=</span> <span class="s2">&quot;ACACGGATT&quot;</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="s2">&quot;CGGTATT&quot;</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">getOverlap</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">)</span>
<span class="n">printAligns</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X3</span> <span class="o">=</span> <span class="s2">&quot;GTCAGTCAATCTACTCGGAAACTATACACCG&quot;</span>
<span class="n">Y3</span> <span class="o">=</span> <span class="s2">&quot;AACTATTTCCGTAACACGGATT&quot;</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">getOverlap</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">X3</span><span class="p">,</span><span class="n">Y3</span><span class="p">)</span>
<span class="n">printAligns</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">X4</span> <span class="o">=</span> <span class="s2">&quot;ATCGGTTCGGTGAAGTAA&quot;</span>
<span class="n">Y4</span> <span class="o">=</span> <span class="s2">&quot;CGGTGACGTTACCATATCCAG&quot;</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">computeMatrix</span><span class="p">(</span><span class="n">X4</span><span class="p">,</span><span class="n">Y4</span><span class="p">,</span> <span class="n">minLen</span> <span class="o">=</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">getOverlap</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">X4</span><span class="p">,</span><span class="n">Y4</span><span class="p">)</span>
<span class="n">printAligns</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The overlap matrix for CTCGGCCCTAGG and GGCTCTAGGCCC:
        -       G       G       C       T       C       T       A       G       G       C       C       C
-       0       inf     inf     inf     inf     inf     inf     inf     inf     inf     inf     inf     inf
C       0       4       12      20      28      36      44      52      60      68      76      84      92
T       0       4       8       14      20      28      36      44      52      60      68      76      84
C       0       4       8       8       16      20      28      36      44      52      60      68      76
G       0       0       4       12      12      20      24      30      36      44      52      60      68
G       0       0       0       8       16      16      24      26      30      36      44      52      60
C       0       4       4       0       8       16      18      26      30      34      36      44      52
C       0       4       8       4       2       8       16      22      30      34      34      36      44
C       0       4       8       8       6       2       10      18      26      34      34      34      36
T       inf     4       8       10      8       8       2       10      18      26      34      36      36
A       inf     12      6       12      14      12      10      2       10      18      26      34      40
G       inf     20      12      10      16      18      16      10      2       10      18      26      34
G       inf     inf     inf     inf     inf     20      22      18      10      2       10      18      26
Overlap between CTCCGGCCCTAGG and GGCTCTAGGCCC:
CTCCGGCCCTAGG
    GGCTCTAGGCCC


The overlap matrix for AATATACATAC and TACGTACTTA:
        -       T       A       C       G       T       A       C       T       T       A
-       0       inf     inf     inf     inf     inf     inf     inf     inf     inf     inf
A       0       4       12      20      28      36      44      52      60      68      76
A       0       4       4       12      20      28      36      44      52      60      68
T       0       0       8       6       14      20      28      36      44      52      60
A       0       4       0       8       8       16      20      28      36      44      52
T       0       0       8       2       10      8       16      22      28      36      44
A       0       4       0       8       4       12      8       16      24      32      36
C       0       2       8       0       8       6       14      8       16      24      32
A       0       4       2       8       2       10      6       14      12      20      24
T       inf     0       8       4       10      2       10      8       14      12      20
A       inf     8       0       8       6       10      2       10      12      18      12
C       inf     inf     inf     inf     8       8       10      2       10      14      20
Overlap between AATAATACATAC and TACGTACTTA:
AATAATACATAC
     TACGTACTTA


Overlap between ACAACGG-ATT and CGGTATT:
ACAACGG-ATT
    CGGTATT


Overlap between GTCAGTCAATCTACTCGGAAAACTATACACCG and AACTATTTC-CGTAACACGGATT:
GTCAGTCAATCTACTCGGAAAACTATACACCG
                    AACTATTTC-CGTAACACGGATT


Overlap between ATCGGTTTCGGTGAAGTAA and CGGTGACGTTACCATATCCAG:
ATCGGTTTCGGTGAAGTAA
        CGGTGACGTTACCATATCCAG
</pre></div></div>
</div>
<p>Download the complete source file: <a class="reference external" href="programming_paradigms/GetOverlap.py">GetOverlap.py</a></p>
</div></div>
</div>
<div class="section" id="Greedy-programming">
<h2>Greedy programming<a class="headerlink" href="#Greedy-programming" title="Permalink to this headline">¶</a></h2>
<p>In the <strong>greedy programming</strong> paradigm, at each step of the computation the choice that seems the best <strong>at the time</strong> is always taken. In other words, greedy algorithms build a solution by choosing the <strong>local best value</strong> in the hope that this would lead to a <strong>global best solution</strong>. As we will see later, this is not always guaranteed.</p>
<p><strong>Example:</strong> Let’s write a method that a vending machine can use to give change using the least amount of coins of 50, 20, 10, 5, and 1 cents.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">giveChange</span><span class="p">(</span><span class="n">amount</span><span class="p">):</span>
    <span class="c1">#res counts the used coins</span>
    <span class="c1">#having value 50,20,10,5,1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing change of </span><span class="si">{}</span><span class="s2"> cents&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">amount</span><span class="p">))</span>
    <span class="n">coins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#order makes greedy choice! First 50,then 20, 10...</span>
        <span class="k">if</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="k">elif</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">elif</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">elif</span> <span class="n">amount</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nextCoin</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">amount</span> <span class="o">-=</span> <span class="n">nextCoin</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coins</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> x </span><span class="si">{}</span><span class="s2"> cent coins&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coins</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>


<span class="n">giveChange</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
<span class="n">giveChange</span><span class="p">(</span><span class="mi">72</span><span class="p">)</span>
<span class="n">giveChange</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing change of 36 cents
1 x 20 cent coins
1 x 10 cent coins
1 x 5 cent coins
1 x 1 cent coins
Computing change of 72 cents
1 x 50 cent coins
1 x 20 cent coins
2 x 1 cent coins
Computing change of 232 cents
4 x 50 cent coins
1 x 20 cent coins
1 x 10 cent coins
2 x 1 cent coins
</pre></div></div>
</div>
<p>In the previous case, the <strong>greedy choice</strong> was to pick all the time the coin with highest possible value.</p>
<p>Greedy algorithms sometimes do not produce the <strong>optimal best solution</strong>.</p>
<p>Considering the following tree, if the goal is to find the maximum sum from root to leaves of a tree, a greedy algorithm that always picks the biggest value would not lead to the correct solution:</p>
<img alt="_images/tree_gt_edited.png" src="_images/tree_gt_edited.png" />
<p>where greedy choices have been highlighted in red.</p>
<p>Note that greedy algorithms stop when no more choices can be made, without looking back (back-tracking) to see if any better solution could be found. Despite the limitations, sometimes greedy algorithms can provide a close enough approssimation of the global optimum solution.</p>
<div class="section" id="Exercises">
<h3>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="3">
<li><p>Egyptian fractions (<a class="reference external" href="https://en.wikipedia.org/wiki/Egyptian_fraction">info here</a>) are fractions where the numerator is 1 and the denominator is a positive integer. Every fraction can be represented as a sum of Egyptian fractions (an infinite number of fractions actually). The algorithm that, given a fraction <span class="math notranslate nohighlight">\(\frac{N}{D}\)</span> produces one equivalent Egyptian fraction is the following:</p></li>
</ol>
<ol class="loweralpha simple">
<li><p>find the greatest possible unit fraction <span class="math notranslate nohighlight">\(U=\frac{1}{x}\)</span> still dividing <span class="math notranslate nohighlight">\(\frac{N}{D}\)</span> (this is <span class="math notranslate nohighlight">\(x=\lceil \frac{D}{N}\rceil\)</span>) (<strong>note that this is a greedy choice!</strong>);</p></li>
<li><p>store <span class="math notranslate nohighlight">\(x\)</span>, compute <span class="math notranslate nohighlight">\(\frac{N}{D} - \frac{1}{x}\)</span> updating <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(D\)</span> and repeat until the remaining fraction becomes 0 (i.e. the numerator becomes 0);</p></li>
</ol>
<p>Implement a <code class="docutils literal notranslate"><span class="pre">Fraction</span></code> class (having two attributes denominator and numerator) and a <code class="docutils literal notranslate"><span class="pre">getEgyptianFraction</span></code> method that returns a list of Fraction objects representing the same fraction.</p>
<div class="tggle" onclick="toggleVisibility(&#39;Ex3&#39;);"><p>Show/Hide Solution</p>
</div><div id="Ex3" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">Fraction</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__num</span> <span class="o">=</span> <span class="n">num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__den</span> <span class="o">=</span> <span class="n">den</span>

    <span class="k">def</span> <span class="nf">getNumerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__num</span>

    <span class="k">def</span> <span class="nf">getDenominator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__den</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__den</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">getEgyptianFraction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__num</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__den</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

        <span class="k">while</span> <span class="n">n</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">f</span> <span class="o">-</span> <span class="n">d</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">f</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">]</span>


<span class="n">F</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ef</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">getEgyptianFraction</span><span class="p">()</span>
<span class="n">outStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ef</span><span class="p">)):</span>
    <span class="n">outStr</span> <span class="o">+=</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1232</span><span class="p">,</span><span class="mi">450</span><span class="p">)</span>
<span class="n">ef</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">getEgyptianFraction</span><span class="p">()</span>
<span class="n">outStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ef</span><span class="p">)):</span>
    <span class="n">outStr</span> <span class="o">+=</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">186</span><span class="p">,</span><span class="mi">61</span><span class="p">)</span>
<span class="n">ef</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">getEgyptianFraction</span><span class="p">()</span>
<span class="n">outStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ef</span><span class="p">)):</span>
    <span class="n">outStr</span> <span class="o">+=</span> <span class="s2">&quot; + &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ef</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outStr</span><span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
7/12 = 1/2 + 1/12

1232/450 = 1/1 + 1/1 + 1/2 + 1/5 + 1/27 + 1/1350

186/61 = 1/1 + 1/1 + 1/1 + 1/21 + 1/641 + 1/821121
</pre></div></div>
</div>
<p>Download the complete source file: <a class="reference external" href="programming_paradigms/Fraction.py">Fraction.py</a></p>
</div><ol class="arabic simple" start="4">
<li><p>The algorithm of Dijsktra is a very important algorithm to find the shortest path among a node and all the others in a weighted graph. The pseudocode of the algorithm follows (credit: <a class="reference external" href="http://www.gitta.info/Accessibiliti/en/html/Dijkstra_learningObject1.html">http://www.gitta.info/Accessibiliti/en/html/Dijkstra_learningObject1.html</a>):</p></li>
</ol>
<img alt="_images/dijkstra.png" src="_images/dijkstra.png" />
<p>Note that the algorithm is greedy in the sense that at each iteration the node with the smallest distance is picked. Implement the algorithm of Dijstra for the <code class="docutils literal notranslate"><span class="pre">DiGrapLL</span></code> class.</p>
<p>Modify the algorithm to report the shortest path between two nodes.</p>
<p>Test the code with the following graph:</p>
<img alt="_images/testgraph.png" src="_images/testgraph.png" />
<p>which can be obtained by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>G = DiGraphLLAnalyzer()
for i in range(1,10):
    G.insertNode(&quot;Node_&quot; + str(i))

G.insertEdge(&quot;Node_1&quot;, &quot;Node_2&quot;,5)
G.insertEdge(&quot;Node_2&quot;, &quot;Node_1&quot;,7)
G.insertEdge(&quot;Node_1&quot;, &quot;Node_3&quot;,11)
G.insertEdge(&quot;Node_1&quot;, &quot;Node_5&quot;,9)
G.insertEdge(&quot;Node_2&quot;, &quot;Node_3&quot;,1)
G.insertEdge(&quot;Node_2&quot;, &quot;Node_5&quot;,2)
G.insertEdge(&quot;Node_3&quot;, &quot;Node_4&quot;,3)
G.insertEdge(&quot;Node_3&quot;, &quot;Node_6&quot;,2)
G.insertEdge(&quot;Node_5&quot;, &quot;Node_3&quot;,2)
G.insertEdge(&quot;Node_5&quot;, &quot;Node_5&quot;,5)
G.insertEdge(&quot;Node_6&quot;, &quot;Node_4&quot;,7)
G.insertEdge(&quot;Node_6&quot;, &quot;Node_6&quot;,4)
G.insertEdge(&quot;Node_7&quot;, &quot;Node_5&quot;,3)
G.insertEdge(&quot;Node_5&quot;, &quot;Node_8&quot;,1)
G.insertEdge(&quot;Node_8&quot;, &quot;Node_7&quot;,12)
G.insertEdge(&quot;Node_9&quot;, &quot;Node_2&quot;,10)

root = &quot;Node_1&quot;
D,P = G.Dijkstra(root)

for dist in D:
    if D[dist] != math.inf:
        print(&quot;Distance {} - {}: {}&quot;.format(root,
                                            dist,
                                            D[dist]))
        prev = P.get(dist,None)
        tmp = dist
        cnt = 0
        while prev != None:
            print(&quot;{}{} &lt;-- {}&quot;.format(&quot;\t&quot;*cnt,tmp,prev))
            tmp = prev
            prev = P.get(prev,None)
            cnt += 1
</pre></div>
</div>
<div class="tggle" onclick="toggleVisibility(&#39;Ex4&#39;);"><p>Show/Hide Solution</p>
</div><div id="Ex4" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">DiGraphLL</span><span class="p">:</span>

    <span class="c1"># ... missing code ...</span>

<span class="k">class</span> <span class="nc">DiGraphLLAnalyzer</span><span class="p">(</span><span class="n">DiGraphLL</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">Dijkstra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">root</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns a dictionary with all the distances</span>
<span class="sd">        node by node and a previous structure</span>
<span class="sd">        to go from one node to the root through the</span>
<span class="sd">        shortest path</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">findNodeWithMinWeight</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">nodes</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            helper function to find the node</span>
<span class="sd">            with minimum weight among a set</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">minNode</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">minWeight</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">minNode</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">minWeight</span><span class="p">:</span>
                    <span class="n">minWeight</span> <span class="o">=</span> <span class="n">w</span>
                    <span class="n">minNode</span> <span class="o">=</span> <span class="n">node</span>
            <span class="k">return</span> <span class="n">minNode</span><span class="p">,</span><span class="n">minWeight</span>

        <span class="n">dist</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">prev</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
            <span class="n">dist</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>

        <span class="n">dist</span><span class="p">[</span><span class="n">root</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
        <span class="n">Q</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
        <span class="c1">#print(Q)</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">N</span><span class="p">,</span><span class="n">distN</span> <span class="o">=</span> <span class="n">findNodeWithMinWeight</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>

            <span class="n">Q</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="c1">#print(Q)</span>
            <span class="n">outgoingEdges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adjacentEdge</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">incoming</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
            <span class="c1">#print(outgoingEdges)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outgoingEdges</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">outgoingEdges</span><span class="p">:</span>
                    <span class="c1">#edge is like (n, otherNode, weight)</span>
                    <span class="n">newDist</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">distN</span>

                    <span class="k">if</span> <span class="n">newDist</span> <span class="o">&lt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                        <span class="n">dist</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">newDist</span>
                        <span class="n">prev</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dist</span><span class="p">,</span><span class="n">prev</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">DiGraphLLAnalyzer</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">G</span><span class="o">.</span><span class="n">insertNode</span><span class="p">(</span><span class="s2">&quot;Node_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_2&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_1&quot;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_3&quot;</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_1&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_5&quot;</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_3&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_2&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_5&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_3&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_4&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_3&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_6&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_5&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_3&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_5&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_5&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_6&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_4&quot;</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_6&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_6&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_7&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_5&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_5&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_8&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_8&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_7&quot;</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">insertEdge</span><span class="p">(</span><span class="s2">&quot;Node_9&quot;</span><span class="p">,</span> <span class="s2">&quot;Node_2&quot;</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">root</span> <span class="o">=</span> <span class="s2">&quot;Node_1&quot;</span>
    <span class="n">D</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">Dijkstra</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">D</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">D</span><span class="p">[</span><span class="n">dist</span><span class="p">]</span> <span class="o">!=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Distance </span><span class="si">{}</span><span class="s2"> - </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">root</span><span class="p">,</span>
                                                <span class="n">dist</span><span class="p">,</span>
                                                <span class="n">D</span><span class="p">[</span><span class="n">dist</span><span class="p">]))</span>
            <span class="n">prev</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">dist</span>
            <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">prev</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2"> &lt;-- </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">*</span><span class="n">cnt</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="n">prev</span><span class="p">))</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">prev</span>
                <span class="n">prev</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prev</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Distance Node_1 - Node_2: 5
Node_2 &lt;-- Node_1

Distance Node_1 - Node_5: 7
Node_5 &lt;-- Node_2
        Node_2 &lt;-- Node_1

Distance Node_1 - Node_3: 6
Node_3 &lt;-- Node_2
        Node_2 &lt;-- Node_1

Distance Node_1 - Node_7: 20
Node_7 &lt;-- Node_8
        Node_8 &lt;-- Node_5
                Node_5 &lt;-- Node_2
                        Node_2 &lt;-- Node_1

Distance Node_1 - Node_1: 0

Distance Node_1 - Node_8: 8
Node_8 &lt;-- Node_5
        Node_5 &lt;-- Node_2
                Node_2 &lt;-- Node_1

Distance Node_1 - Node_4: 9
Node_4 &lt;-- Node_3
        Node_3 &lt;-- Node_2
                Node_2 &lt;-- Node_1

Distance Node_1 - Node_6: 8
Node_6 &lt;-- Node_3
        Node_3 &lt;-- Node_2
                Node_2 &lt;-- Node_1
</pre></div></div>
</div>
<p>Download the complete source file: <a class="reference external" href="programming_paradigms/DiGraphLLAnalyzerEx4.py">DiGraphLLAnalyzerEx4.py</a></p>
</div></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright # 2021 - 2021, Luca Marchetti

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>