

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module 1, Practical 8 &mdash; QCB Scientific Programming Lab</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/js/jupman.js"></script>
        <script type="text/javascript" src="_static/js/pytutor-embed.bundle.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/jupman.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/jupman-web.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="toc-page.html" class="icon icon-home"> QCB Scientific Programming Lab
          

          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Scientific Programming for QCB</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#General-Info">General Info</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#Timetable-and-lecture-rooms">Timetable and lecture rooms</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Zoom-links">Zoom links</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Equipment">Equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#Acknowledgements">Acknowledgements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical1.html">Module 1, Practical 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Setting-up-the-environment">Setting up the environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#Linux-on-windows">Linux on windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#A-dual-boot-system">A dual boot system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Our-toolbox">Our toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Installing-Python3-in-Linux">Installing Python3 in Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Installing-Python3-in-Windows/Mac">Installing Python3 in Windows/Mac</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#OPTION-1:">OPTION 1:</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#OPTION-2-(easier):">OPTION 2 (easier):</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#The-console">The console</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Visual-Studio-Code">Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#The-debugger">The debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#A-quick-Jupyter-primer-(just-for-your-information,-skip-if-not-interested)">A quick Jupyter primer (just for your information, skip if not interested)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical1.html#Installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical1.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical2.html">Module 1, Practical 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Objects">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Numeric-types">Numeric types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Integers">Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Booleans">Booleans</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Real-numbers">Real numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Strings">Strings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical2.html#Methods-for-the-str-object">Methods for the str object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical2.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical3.html">Module 1, Practical 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Lists">Lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#Operators-for-lists">Operators for lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#Methods-of-the-class-list">Methods of the class list</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#From-strings-to-lists,-the-split-method">From strings to lists, the <code class="docutils literal notranslate"><span class="pre">split</span></code> method</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical3.html#And-back-to-strings-with-the-join-method">And back to strings with the <code class="docutils literal notranslate"><span class="pre">join</span></code> method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Tuples">Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Introduction-to-sets">Introduction to sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical3.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical4.html">Module 1, Practical 4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Execution-flow">Execution flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Conditionals">Conditionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#The-basic-if---else-statement">The basic <em>if - else</em> statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#The-if---elif---else-statement">The <em>if - elif - else</em> statement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Loops">Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#For-loop">For loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#Looping-over-a-range">Looping over a range</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#Nested-for-loops">Nested for loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical4.html#While-loops">While loops</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical4.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical5.html">Module 1, Practical 5</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#More-on-loops">More on loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Ternary-operator">Ternary operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Break-and-continue">Break and continue</a><ul>
<li class="toctree-l4"><a class="reference internal" href="M1_practical5.html#Continue-statement">Continue statement</a></li>
<li class="toctree-l4"><a class="reference internal" href="M1_practical5.html#Break-statement">Break statement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#List-comprehension">List comprehension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#Dictionaries">Dictionaries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Functions-working-on-dictionaries">Functions working on dictionaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical5.html#Dictionary-methods">Dictionary methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical5.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical6.html">Module 1, Practical 6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical6.html#Functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical6.html#Namespace-and-variable-scope">Namespace and variable scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical6.html#Argument-passing">Argument passing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Positional-arguments">Positional arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Passing-arguments-by-keyword">Passing arguments by keyword</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Specifying-default-values">Specifying default values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical6.html#File-input-and-output">File input and output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Opening-a-file">Opening a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Closing-a-file">Closing a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Reading-from-a-file">Reading from a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#Writing-to-a-file">Writing to a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="M1_practical6.html#String-formatting-with-format">String formatting with format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical6.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="M1_practical7.html">Module 1, Practical 7</a><ul>
<li class="toctree-l2"><a class="reference internal" href="M1_practical7.html#Gentle-reminder-on-functions">Gentle reminder on functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical7.html#Getting-input-from-the-command-line">Getting input from the command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical7.html#Argparse">Argparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical7.html#Libraries-installation-for-the-next-practicals">Libraries installation for the next practicals</a></li>
<li class="toctree-l2"><a class="reference internal" href="M1_practical7.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="toc.html"> </a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="toc-page.html">QCB Scientific Programming Lab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          


    <div id='jupman-langs'></div>

    <!-- SMALL TEMPLATE FOR LANGUAGES (VERY CUSTOM FOR softpython.org !!)
    <script>
    var hn = window.location.hostname;
    var pn = window.location.pathname;

    if (hn.includes('softpython.org')){
        JUPMAN_LANG = hn.slice(0,window.location.hostname.indexOf('.'));
    } else if (pn.includes('/_build/html')){
        var pos = pn.indexOf('/_build/html');
        JUPMAN_LANG = pn.slice(pos-2, pos);
    } else {
        JUPMAN_LANG = 'en';
    }
    console.log('JUPMAN_LANG=',JUPMAN_LANG);
    </script>
    -->
    
    
     <!-- <li> <h2 style="background-color:red; color:yellow">WARNING! THIS VERSION IS OLD !  <br/>
    <a style=" text-decoration: underline;" href="https://jupman.readthedocs.io/en/latest">GOT TO LATEST VERSION</a></li>
 </h2></li>-->
    <!-- Commented because doesn't work with sections,
         see https://github.com/DavidLeoni/jupman/issues/39
    <li><a href="toc-page.html">Docs</a> &raquo;</li>
    
    <li>Module 1, Practical 8</li>
    -->

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Module-1,-Practical-8">
<h1>Module 1, Practical 8<a class="headerlink" href="#Module-1,-Practical-8" title="Permalink to this headline">¶</a></h1>
<p>In this practical we will will practice Pandas.</p>
<div class="section" id="Libraries-installation">
<h2>Libraries installation<a class="headerlink" href="#Libraries-installation" title="Permalink to this headline">¶</a></h2>
<p>First things first. Let’s start off by installing the required libraries. In particular we will need three libraries. Try and see if they are already available by typing the following commands in the console or put them in a python script:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
</pre></div>
</div>
<p>if, upon execution, you do not get any error messages, you are sorted. Otherwise, you need to install them.</p>
<p>In <strong>Linux</strong> you can install the libraries by typing in a terminal <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">numpy</span></code> (or <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">python3.X</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">python3.X</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">python3.X</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">numpy</span></code>), where X is your python version.</p>
<p>In <strong>Windows</strong> you can install the libraries by typing in the command prompt (to open it type <code class="docutils literal notranslate"><span class="pre">cmd</span></code> in the search box) <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code>, <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">pandas</span></code> and <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">numpy</span></code>. If you are using anaconda you need to run these commands from the <em>anaconda prompt</em>.</p>
<p><strong>Please install them in this order</strong> (i.e. <strong>matplotlib</strong> first, then <strong>pandas</strong> and finally <strong>numpy</strong>). You might not need to install numpy as matplotlib requires it. Once done that, try to perform the above imports again and they should work this time around.</p>
</div>
<div class="section" id="Pandas">
<h2>Pandas<a class="headerlink" href="#Pandas" title="Permalink to this headline">¶</a></h2>
<p>Pandas (the name comes from <em>panel data</em>) is a very efficient library to deal with numerical tables and time series. It is a quite complex library and here we will only scratch the surface of it. You can find a lot of information including the documentation on the <a class="reference external" href="http://pandas.pydata.org">Pandas website</a>.</p>
<p>In particular the library pandas provides two data structures: <strong>Series</strong> and <strong>DataFrames</strong>.</p>
</div>
<div class="section" id="Series">
<h2>Series<a class="headerlink" href="#Series" title="Permalink to this headline">¶</a></h2>
<p>Series are 1-dimensional structures (like lists) containing data. Series are characterized by two types of information: the <strong>values</strong> and the <strong>index</strong> (a list of labels associated to the data), therefore they are a bit like a list and a bit like a dictionary. The index is optional and can be added by the library if not specified.</p>
<div class="section" id="How-to-define-and-access-a-Series">
<h3>How to define and access a Series<a class="headerlink" href="#How-to-define-and-access-a-Series" title="Permalink to this headline">¶</a></h3>
<p>There are several ways to define a Series. We can specify both the values and the index explicitly, or through a dictionary, or let python add the default index for us. We can access the index with the <strong>Series.index</strong> method and the values with the <strong>Series.values</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Values and index explicitly defined&quot;</span><span class="p">)</span>
<span class="c1">#values and index explicitely defined</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The index:&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The values:&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;From dictionary&quot;</span><span class="p">)</span>
<span class="c1">#from a dictionary</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s2">&quot;one&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;ten&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="s2">&quot;three&quot;</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;four&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;forty&quot;</span> <span class="p">:</span> <span class="mi">40</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default index&quot;</span><span class="p">)</span>
<span class="c1">#index added by default</span>
<span class="n">myData</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S2</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Same value repeated&quot;</span><span class="p">)</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="mf">1.27</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S3</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Values and index explicitly defined
A     1
B     9
C     4
D     7
E    20
F     7
G    13
H    10
I     4
L     8
dtype: int64
The index: Index([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;L&#39;], dtype=&#39;object&#39;)
The values: [ 1  9  4  7 20  7 13 10  4  8]
------------------------

From dictionary
one       1
two       2
ten      10
three     3
four      4
forty    40
dtype: int64
Index([&#39;one&#39;, &#39;two&#39;, &#39;ten&#39;, &#39;three&#39;, &#39;four&#39;, &#39;forty&#39;], dtype=&#39;object&#39;)
[ 1  2 10  3  4 40]
------------------------

Default index
0    3
1    3
2    2
3    0
4    3
5    8
6    2
7    3
8    7
9    7
dtype: int64
RangeIndex(start=0, stop=10, step=1)
[3 3 2 0 3 8 2 3 7 7]
------------------------

Same value repeated
0    1.27
1    1.27
2    1.27
3    1.27
4    1.27
5    1.27
6    1.27
7    1.27
8    1.27
9    1.27
dtype: float64
RangeIndex(start=0, stop=10, step=1)
[1.27 1.27 1.27 1.27 1.27 1.27 1.27 1.27 1.27 1.27]
</pre></div></div>
</div>
<p>Data in a series can be accessed by using the <strong>label</strong> (i.e. the index) as in a dictionary or through its <strong>position</strong> as in a list. Slicing is also allowed both by <strong>position</strong> and <strong>index</strong>. In the latter case, we can do <code class="docutils literal notranslate"><span class="pre">Series[S:E]</span></code> with <strong>S and E indexes</strong>, both <strong>S and E are included</strong>.</p>
<p>It is also possible to retrieve some elements by passing a <strong>list</strong> of positions or indexes. <strong>Head</strong> and <strong>tail</strong> methods can also be used to retrieve the top or bottom N elements with <strong>Series.head(N)</strong> or <strong>Series.tail(N)</strong>.</p>
<div class="admonition note">
<p><strong>Note:</strong> When the method returns more than one element, the return type is a Series.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1">#values and index explicitely defined</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value at label </span><span class="se">\&quot;</span><span class="s2">A</span><span class="se">\&quot;</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="n">S</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Value at index 1:&quot;</span><span class="p">,</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slicing from 1 to 3:&quot;</span><span class="p">)</span> <span class="c1">#note 3 excluded</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Slicing from C to H:&quot;</span><span class="p">)</span> <span class="c1">#note H included!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">:</span><span class="s2">&quot;H&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving from list:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="s2">&quot;G&quot;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bottom 3&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A     1
B    19
C    10
D     5
E     9
F    12
G     9
H     4
I    12
L    10
dtype: int64

Value at label &#34;A&#34;: 1
Value at index 1: 19

Slicing from 1 to 3:
B    19
C    10
dtype: int64

Slicing from C to H:
C    10
D     5
E     9
F    12
G     9
H     4
dtype: int64

Retrieving from list:
B    19
D     5
F    12
H     4
L    10
dtype: int64
A     1
C    10
E     9
G     9
dtype: int64

Top 3
A     1
B    19
C    10
dtype: int64

Bottom 3
H     4
I    12
L    10
dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Operator-broadcasting">
<h3>Operator broadcasting<a class="headerlink" href="#Operator-broadcasting" title="Permalink to this headline">¶</a></h3>
<p>Operations can automatically be broadcast to the entire Series. This is a quite cool feature and saves us from looping through the elements of the Series.</p>
<p><strong>Example:</strong> Given a list of 10 integers and we want to divide them by 2. Without using pandas we would:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">listS</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">listS</span><span class="p">)</span>

<span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">listS</span><span class="p">)):</span>
    <span class="n">listS</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="o">/=</span><span class="mi">2</span>  <span class="c1">#compact of X = X / 2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">listS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[11, 9, 18, 16, 3, 19, 12, 7, 14, 17]
[5.5, 4.5, 9.0, 8.0, 1.5, 9.5, 6.0, 3.5, 7.0, 8.5]
</pre></div></div>
</div>
<p>With pandas instead:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">S</span> <span class="o">/</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A     9
B     0
C     5
D     7
E     1
F    18
G    10
H    18
I     4
L    18
dtype: int64

A    4.5
B    0.0
C    2.5
D    3.5
E    0.5
F    9.0
G    5.0
H    9.0
I    2.0
L    9.0
dtype: float64
</pre></div></div>
</div>
</div>
<div class="section" id="Filtering">
<h3>Filtering<a class="headerlink" href="#Filtering" title="Permalink to this headline">¶</a></h3>
<p>We can also apply boolean operators to obtain only the <strong>sub-Series</strong> with all the values satisfying a specific condition. This allows us to <strong>filter</strong> the Series.</p>
<p>Calling the boolean operator on the series alone (e.g. S &gt; 10) will return a Series with True at the indexes where the condition is met, False at the others. Passing such a Series to a Series of the same length will return only the elements where the condition is True. Check the code below to see this in action.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">S</span><span class="o">&gt;</span><span class="mi">10</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">S</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A     0
B     5
C     0
D    11
E     6
F    14
G    18
H    15
I     0
L     0
dtype: int64

A    False
B    False
C    False
D     True
E    False
F     True
G     True
H     True
I    False
L    False
dtype: bool

D    11
F    14
G    18
H    15
dtype: int64
</pre></div></div>
</div>
</div>
<div class="section" id="Missing-data">
<h3>Missing data<a class="headerlink" href="#Missing-data" title="Permalink to this headline">¶</a></h3>
<p>Operations involving Series might have to deal with missing data or non-valid values (both cases are represented as <strong>NaN</strong>, that is <strong>not a number</strong>). Operations are carried out by aligning the Series based on their <strong>indexes</strong>. Indexes not in common end up in NaN values. Although most of the operations that can be performed on series quite happily deal with NaNs, it is possible to <strong>drop</strong> NaN values or to <strong>fill</strong> them (i.e. replace their value with some other value). The sytax is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Series.dropna()
</pre></div>
</div>
<p>or</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Series.fillna(some_value)
</pre></div>
</div>
<p><strong>Note that these operations do not modify the Series but rather return a new Series</strong>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>

<span class="n">S1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;DEFGHAZY&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The dimensions of these Series:&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---- S + S1 ----&quot;</span><span class="p">)</span>
<span class="n">Ssum</span> <span class="o">=</span> <span class="n">S</span> <span class="o">+</span> <span class="n">S1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ssum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---- Dropping NaNs ----&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ssum</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---- Filling NaNs ----&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ssum</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;my_value&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The dimensions of these Series: (10,)

D    8
E    3
F    0
G    8
H    9
A    5
Z    1
Y    1
dtype: int64
---- S + S1 ----
A     5.0
B     NaN
C     NaN
D    15.0
E    12.0
F     4.0
G     9.0
H    18.0
I     NaN
L     NaN
Y     NaN
Z     NaN
dtype: float64
---- Dropping NaNs ----
A     5.0
D    15.0
E    12.0
F     4.0
G     9.0
H    18.0
dtype: float64
---- Filling NaNs ----
A           5
B    my_value
C    my_value
D          15
E          12
F           4
G           9
H          18
I    my_value
L    my_value
Y    my_value
Z    my_value
dtype: object
</pre></div></div>
</div>
</div>
<div class="section" id="Computing-stats">
<h3>Computing stats<a class="headerlink" href="#Computing-stats" title="Permalink to this headline">¶</a></h3>
<p>Pandas offers several operators to compute stats on the data stored in a Series. These include basic stats like <strong>min</strong>, <strong>max</strong> (and relative indexes with <strong>argmin</strong> and <strong>argmax</strong>) <strong>mean</strong>, <strong>std</strong>, <strong>quantile</strong> (to get the quantiles). A description of the data can be obtained by using the method <strong>describe</strong> and the counts for each value can be obtained by <strong>value_counts</strong>. Other methods available are <strong>sum</strong> and <strong>cumsum</strong> (for the sum and cumulative sum of the elements), <strong>autocorr</strong> and
<strong>corr</strong> (for autocorrelation and correlation) and many others. For a complete list check the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html">Pandas reference</a>.</p>
<p><strong>Note: as said before, when these methods do not return a single value, they return a Series.</strong></p>
<p><strong>Example:</strong> Fill the previous Series with the mean values of the series rather than NaNs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Ssum</span> <span class="o">=</span> <span class="n">S</span> <span class="o">+</span> <span class="n">S1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ssum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---- Filling with avg value ----&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ssum</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">Ssum</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Min:</span><span class="si">{}</span><span class="s2"> (index: </span><span class="si">{}</span><span class="s2">) Max: </span><span class="si">{}</span><span class="s2"> (index: </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Ssum</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                      <span class="n">Ssum</span><span class="o">.</span><span class="n">argmin</span><span class="p">(),</span>
                                                      <span class="n">Ssum</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                                      <span class="n">Ssum</span><span class="o">.</span><span class="n">argmax</span><span class="p">()))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
A     5.0
B     NaN
C     NaN
D    15.0
E    12.0
F     4.0
G     9.0
H    18.0
I     NaN
L     NaN
Y     NaN
Z     NaN
dtype: float64
---- Filling with avg value ----
A     5.0
B    10.5
C    10.5
D    15.0
E    12.0
F     4.0
G     9.0
H    18.0
I    10.5
L    10.5
Y    10.5
Z    10.5
dtype: float64
Min:4.0 (index: 5) Max: 18.0 (index: 7)
</pre></div></div>
</div>
<p>Let’s see some operators introduced above in action.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Its description&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specifying different quantiles:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.9</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Histogram:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The type is a Series:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summing the values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The cumulative sum:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The data:
A     0
B     8
C     5
D    10
E     5
F     7
G     0
H     7
I     9
L     9
dtype: int64

Its description
count    10.000000
mean      6.000000
std       3.559026
min       0.000000
25%       5.000000
50%       7.000000
75%       8.750000
max      10.000000
dtype: float64

Specifying different quantiles:
0.1    0.0
0.2    4.0
0.8    9.0
0.9    9.1
dtype: float64

Histogram:
9     2
7     2
5     2
0     2
10    1
8     1
dtype: int64

The type is a Series:
&lt;class &#39;pandas.core.series.Series&#39;&gt;
Summing the values:
60

The cumulative sum:
A     0
B     8
C    13
D    23
E    28
F    35
G    35
H    42
I    51
L    60
dtype: int64
</pre></div></div>
</div>
<p><strong>Example</strong>:</p>
<p>Create two Series from the lists [2, 4, 6, 8, 10, 12, 13, 14, 15, 16], [1, 3, 5, 7, 9, 11, 13, 14, 15, 16] using the same index for both: [‘9B47’, ‘468B’, ‘B228’, ‘3C52’, ‘AE2E’, ‘DFF6’, ‘C38B’, ‘2CE5’, ‘0325’, ‘398F’].</p>
<p>Let’s compare the distribution stats of the two Series (mean value, max, min, quantiles) and get the index and value of the positions where the two series are the same. Finally, let’s get the sub-series where the first has a value higher than the first quartile of the second and compute its stats.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">L1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">L2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]</span>
<span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;9B47&#39;</span><span class="p">,</span> <span class="s1">&#39;468B&#39;</span><span class="p">,</span> <span class="s1">&#39;B228&#39;</span><span class="p">,</span> <span class="s1">&#39;3C52&#39;</span><span class="p">,</span> <span class="s1">&#39;AE2E&#39;</span><span class="p">,</span> <span class="s1">&#39;DFF6&#39;</span><span class="p">,</span> <span class="s1">&#39;C38B&#39;</span><span class="p">,</span> <span class="s1">&#39;2CE5&#39;</span><span class="p">,</span> <span class="s1">&#39;0325&#39;</span><span class="p">,</span> <span class="s1">&#39;398F&#39;</span><span class="p">]</span>
<span class="n">L1Series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">I</span><span class="p">)</span>
<span class="n">L2Series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">I</span><span class="p">)</span>
<span class="c1">#Let&#39;s describe the stats</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stats of L1Series&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L1Series</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stats of L2Series&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L2Series</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#This is a Series with boolean values (True means the two Series where the same)</span>
<span class="n">Leq</span> <span class="o">=</span> <span class="n">L1Series</span> <span class="o">==</span> <span class="n">L2Series</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Equality series&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Leq</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Get the subseries where both are the same</span>
<span class="n">Lsub</span> <span class="o">=</span> <span class="n">L1Series</span><span class="p">[</span><span class="n">Leq</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subseries of identicals&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Lsub</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Get the values that are the same</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Identical values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Lsub</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Get the indexes where the two series are the same</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indexes of identical values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Lsub</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">firstQuartile</span> <span class="o">=</span> <span class="n">L2Series</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first quartile of L2Series:&quot;</span><span class="p">,</span><span class="n">firstQuartile</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Get the subseries in which L1 is bigger than L2</span>
<span class="n">Lbig</span> <span class="o">=</span> <span class="n">L1Series</span><span class="p">[</span><span class="n">L1Series</span> <span class="o">&gt;</span> <span class="n">firstQuartile</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The subseries with L1 &gt; L2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Lbig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Stats of L1Series
count    10.000000
mean     10.000000
std       4.830459
min       2.000000
25%       6.500000
50%      11.000000
75%      13.750000
max      16.000000
dtype: float64

Stats of L2Series
count    10.00000
mean      9.40000
std       5.25357
min       1.00000
25%       5.50000
50%      10.00000
75%      13.75000
max      16.00000
dtype: float64

Equality series
9B47    False
468B    False
B228    False
3C52    False
AE2E    False
DFF6    False
C38B     True
2CE5     True
0325     True
398F     True
dtype: bool

Subseries of identicals
C38B    13
2CE5    14
0325    15
398F    16
dtype: int64

Identical values:
[13 14 15 16]

Indexes of identical values:
Index([&#39;C38B&#39;, &#39;2CE5&#39;, &#39;0325&#39;, &#39;398F&#39;], dtype=&#39;object&#39;)

The first quartile of L2Series: 5.5

The subseries with L1 &gt; L2
B228     6
3C52     8
AE2E    10
DFF6    12
C38B    13
2CE5    14
0325    15
398F    16
dtype: int64
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Plotting-data">
<h2>Plotting data<a class="headerlink" href="#Plotting-data" title="Permalink to this headline">¶</a></h2>
<p>Using python’s matplotlib it is possible to plot data. The basic syntax is <code class="docutils literal notranslate"><span class="pre">Series.plot(kind</span> <span class="pre">=</span> <span class="pre">&quot;type&quot;)</span></code> the parameter <code class="docutils literal notranslate"><span class="pre">kind</span></code> can be used to produce several types of plots (examples include <strong>line</strong>, <strong>hist</strong>, <strong>pie</strong>, <strong>bar</strong>, see <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.plot.html">here</a> for all possible choices). Note that <strong>matplotlib</strong> needs to be imported and the pyplot needs to be shown with <strong>pyplot.show()</strong> to display the plot.</p>
<p>Typically, the following syntax is used to import pyplot (remember also to import pandas):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>import pandas as pd
import matplotlib.pyplot as plt
</pre></div>
</div>
<p>note the use of the alias <code class="docutils literal notranslate"><span class="pre">plt</span></code> for simplicity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span>
              <span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;ABCDEFGHIL&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="n">S</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hist&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;pie&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The data:
A     1
B    10
C     0
D     5
E     6
F     8
G     4
H     5
I    10
L     3
dtype: int64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.figure.Figure at 0x7f964c553630&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.figure.Figure at 0x7f95f8b2eb38&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.figure.Figure at 0x7f9601b9eb00&gt;
</pre></div></div>
</div>
<p><strong>Example:</strong> Let’s create a series representing the sin, cos and sqrt functions and plot them.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)]</span>


<span class="n">y</span> <span class="o">=</span>  <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mf">3.14</span> <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mf">3.14</span> <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="c1">#print(x)</span>

<span class="n">ySeries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">ySeries1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
<span class="n">ySeries2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>

<span class="n">ySeries</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sin function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ySeries1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Cos function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sin and Cos functions&quot;</span><span class="p">)</span>
<span class="n">ySeries</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ySeries1</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Sin&quot;</span><span class="p">,</span> <span class="s2">&quot;Cos&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">ySeries2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Sqrt function&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ySeries2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ySeries</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ySeries1</span><span class="p">)</span><span class="o">/</span><span class="n">ySeries2</span>
<span class="n">ySeries2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;(sin(x) + 2cos(x)) / sqrt(x)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_21_0.png" src="_images/M1_practical8_21_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_21_1.png" src="_images/M1_practical8_21_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_21_2.png" src="_images/M1_practical8_21_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_21_3.png" src="_images/M1_practical8_21_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_21_4.png" src="_images/M1_practical8_21_4.png" />
</div>
</div>
</div>
<div class="section" id="Pandas-DataFrames">
<h2>Pandas DataFrames<a class="headerlink" href="#Pandas-DataFrames" title="Permalink to this headline">¶</a></h2>
<p>DataFrames in pandas are the 2D analogous of Series. Dataframes are spreadsheet-like data structures with an ordered set of columns that can also be dishomogeneous. We can think about Dataframes as dictionaries of Series, each one representing a named column. Dataframes are described by an <strong>index</strong> that contains the labels of rows and a <strong>columns</strong> structure that holds the labels of the columns.</p>
<p><strong>Note that the operation of extracting a column from a DataFrame returns a Series</strong>. Moreover, most (but not all!) of the operations that apply to Series also apply to DataFrames.</p>
<div class="section" id="Define-a-DataFrame">
<h3>Define a DataFrame<a class="headerlink" href="#Define-a-DataFrame" title="Permalink to this headline">¶</a></h3>
<p>There are several different ways to define a DataFrame. It is possible to create a DataFrame starting from a dictionary having Series as values. In this case, they <strong>keys</strong> of the dictionary are the <strong>columns</strong> of the DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">myData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;temperature&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span><span class="mi">18</span> <span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Jan&quot;</span><span class="p">,</span><span class="s2">&quot;Feb&quot;</span><span class="p">,</span> <span class="s2">&quot;Mar&quot;</span><span class="p">,</span><span class="s2">&quot;Apr&quot;</span><span class="p">,</span><span class="s2">&quot;May&quot;</span><span class="p">,</span><span class="s2">&quot;Jun&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;Jul&quot;</span><span class="p">,</span><span class="s2">&quot;Aug&quot;</span><span class="p">,</span><span class="s2">&quot;Sep&quot;</span><span class="p">,</span><span class="s2">&quot;Oct&quot;</span><span class="p">,</span><span class="s2">&quot;Nov&quot;</span><span class="p">,</span><span class="s2">&quot;Dec&quot;</span><span class="p">]</span>
                             <span class="p">),</span>
    <span class="s2">&quot;dayLength&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">9.7</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">15.6</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">15.9</span><span class="p">,</span>
                             <span class="mf">14.6</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mf">11.4</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">9.3</span><span class="p">],</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Jan&quot;</span><span class="p">,</span><span class="s2">&quot;Feb&quot;</span><span class="p">,</span> <span class="s2">&quot;Mar&quot;</span><span class="p">,</span><span class="s2">&quot;Apr&quot;</span><span class="p">,</span><span class="s2">&quot;May&quot;</span><span class="p">,</span><span class="s2">&quot;Jun&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;Jul&quot;</span><span class="p">,</span><span class="s2">&quot;Aug&quot;</span><span class="p">,</span><span class="s2">&quot;Sep&quot;</span><span class="p">,</span><span class="s2">&quot;Oct&quot;</span><span class="p">,</span><span class="s2">&quot;Nov&quot;</span><span class="p">,</span><span class="s2">&quot;Dec&quot;</span><span class="p">]</span>
                             <span class="p">)</span>

<span class="p">}</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
     temperature  dayLength
Jan            1        9.7
Feb            3       10.9
Mar            8       12.5
Apr           13       14.1
May           17       15.6
Jun           20       16.3
Jul           22       15.9
Aug           22       14.6
Sep           18       13.0
Oct           13       11.4
Nov            6       10.0
Dec            2        9.3
Index([&#39;temperature&#39;, &#39;dayLength&#39;], dtype=&#39;object&#39;)
Index([&#39;Jan&#39;, &#39;Feb&#39;, &#39;Mar&#39;, &#39;Apr&#39;, &#39;May&#39;, &#39;Jun&#39;, &#39;Jul&#39;, &#39;Aug&#39;, &#39;Sep&#39;, &#39;Oct&#39;,
       &#39;Nov&#39;, &#39;Dec&#39;],
      dtype=&#39;object&#39;)
</pre></div></div>
</div>
<p>If the index is not specified, it is given by default:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">myData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;temperature&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>
                               <span class="mi">22</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span><span class="mi">18</span> <span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span>
    <span class="s2">&quot;dayLength&quot;</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">9.7</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mf">14.1</span><span class="p">,</span> <span class="mf">15.6</span><span class="p">,</span>
                             <span class="mf">16.3</span><span class="p">,</span><span class="mf">15.9</span><span class="p">,</span><span class="mf">14.6</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mf">11.4</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">9.3</span><span class="p">])</span>

<span class="p">}</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">DF</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">DF</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
    temperature  dayLength
0             1        9.7
1             3       10.9
2             8       12.5
3            13       14.1
4            17       15.6
5            20       16.3
6            22       15.9
7            22       14.6
8            18       13.0
9            13       11.4
10            6       10.0
11            2        9.3
RangeIndex(start=0, stop=12, step=1)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_25_1.png" src="_images/M1_practical8_25_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_25_2.png" src="_images/M1_practical8_25_2.png" />
</div>
</div>
<p>It is also possible to define a DataFrame from a list of dictionaries holding a set of values rather than Series. Note that when columns do not have the corresponding information a NaN is added. Indexes and columns can be changed after they have been defined.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">myData</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span> <span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="mf">4.1</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span> <span class="p">:</span> <span class="mf">3.2</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

         <span class="p">]</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">myData</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Let&#39;s change the columns and indexes</span>
<span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;val1,val2,val3,val4,val5,val6,val7,val8&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">inds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Day1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day3&quot;</span><span class="p">]</span>

<span class="n">DF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
<span class="n">DF</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">inds</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   A  B    C     D    F     G    H    E
0  1  2  3.2  10.0  NaN   NaN  NaN  NaN
1  1  2  NaN   NaN  3.2  10.0  1.0  NaN
2  1  2  3.2   1.0  3.2  10.0  1.0  4.1

      val1  val2  val3  val4  val5  val6  val7  val8
Day1     1     2   3.2  10.0   NaN   NaN   NaN   NaN
Day2     1     2   NaN   NaN   3.2  10.0   1.0   NaN
Day3     1     2   3.2   1.0   3.2  10.0   1.0   4.1
</pre></div></div>
</div>
</div>
<div class="section" id="Loading-data-from-external-files">
<h3>Loading data from external files<a class="headerlink" href="#Loading-data-from-external-files" title="Permalink to this headline">¶</a></h3>
<p>Pandas also provides methods to load data from external files. In particular, to load data from a .cvs file, we can use the method <code class="docutils literal notranslate"><span class="pre">pandas.read_csv(filename)</span></code>. This method has a lot of parameters, you can see all the details on its usage on the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">official documentation</a>. Some useful optional parameters are the <strong>separator</strong> (to specify the column separator like <code class="docutils literal notranslate"><span class="pre">sep=&quot;\t&quot;</span></code> for tab separated files), the
character to identify comments (<code class="docutils literal notranslate"><span class="pre">comment=&quot;#&quot;</span></code>) or that to skip some lines (like the header for example or any initial comments to the file) <code class="docutils literal notranslate"><span class="pre">skiprows=N</span></code>. The rows to use as column header can be specified with the parameter <code class="docutils literal notranslate"><span class="pre">header</span></code> that accepts a number or a list of numbers. Similarly, the columns to use as index can be specified with the parameter <code class="docutils literal notranslate"><span class="pre">index_col</span></code>.</p>
<p>Another method to read data in is <code class="docutils literal notranslate"><span class="pre">pandas.read_excel(filename)</span></code> that works in a similar way but can load excel files (see <a class="reference external" href="http://pandas.pydata.org/pandas-docs/version/0.20/generated/pandas.read_excel.html">here</a>).</p>
<p><strong>Example:</strong> Let’s load the data stored in a csv datafile <a class="reference external" href="file_samples/sampledata_orders.csv">sampledata_orders.csv</a> in a pandas DataFrame.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/sampledata_orders.csv&quot;</span><span class="p">,</span>
                     <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First 5 entries:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The index:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The column names:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A description of the numerical values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>



</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
First 5 entries:
        Order ID  Order Date Order Priority  Order Quantity       Sales  \
Row ID
1              3  10/13/2010            Low               6    261.5400
49           293   10/1/2012           High              49  10123.0200
50           293   10/1/2012           High              27    244.5700
80           483   7/10/2011           High              30   4965.7595
85           515   8/28/2010  Not Specified              19    394.2700

        Discount       Ship Mode   Profit  Unit Price  Shipping Cost  \
Row ID
1           0.04     Regular Air  -213.25       38.94          35.00
49          0.07  Delivery Truck   457.81      208.16          68.02
50          0.01     Regular Air    46.71        8.69           2.99
80          0.08     Regular Air  1198.97      195.99           3.99
85          0.08     Regular Air    30.94       21.78           5.94

             Customer Name Province   Region Customer Segment  \
Row ID
1       Muhammed MacIntyre  Nunavut  Nunavut   Small Business
49            Barry French  Nunavut  Nunavut         Consumer
50            Barry French  Nunavut  Nunavut         Consumer
80           Clay Rozendal  Nunavut  Nunavut        Corporate
85          Carlos Soltero  Nunavut  Nunavut         Consumer

       Product Category            Product Sub-Category  \
Row ID
1       Office Supplies          Storage &amp; Organization
49      Office Supplies                      Appliances
50      Office Supplies  Binders and Binder Accessories
80           Technology    Telephones and Communication
85      Office Supplies                      Appliances

                                             Product Name Product Container  \
Row ID
1        Eldon Base for stackable storage shelf, platinum         Large Box
49      1.7 Cubic Foot Compact &#34;Cube&#34; Office Refrigera...        Jumbo Drum
50       Cardinal Slant-D® Ring Binder, Heavy Gauge Vinyl         Small Box
80                                                   R380         Small Box
85                               Holmes HEPA Air Purifier        Medium Box

        Product Base Margin   Ship Date
Row ID
1                      0.80  10/20/2010
49                     0.58   10/2/2012
50                     0.39   10/3/2012
80                     0.58   7/12/2011
85                     0.50   8/30/2010

The index:
Int64Index([   1,   49,   50,   80,   85,   86,   97,   98,  103,  107,
            ...
            6492, 6526, 6657, 7396, 7586, 7765, 7766, 7906, 7907, 7914],
           dtype=&#39;int64&#39;, name=&#39;Row ID&#39;, length=8399)

The column names:
Index([&#39;Order ID&#39;, &#39;Order Date&#39;, &#39;Order Priority&#39;, &#39;Order Quantity&#39;, &#39;Sales&#39;,
       &#39;Discount&#39;, &#39;Ship Mode&#39;, &#39;Profit&#39;, &#39;Unit Price&#39;, &#39;Shipping Cost&#39;,
       &#39;Customer Name&#39;, &#39;Province&#39;, &#39;Region&#39;, &#39;Customer Segment&#39;,
       &#39;Product Category&#39;, &#39;Product Sub-Category&#39;, &#39;Product Name&#39;,
       &#39;Product Container&#39;, &#39;Product Base Margin&#39;, &#39;Ship Date&#39;],
      dtype=&#39;object&#39;)

A description of the numerical values:
           Order ID  Order Quantity         Sales     Discount        Profit  \
count   8399.000000     8399.000000   8399.000000  8399.000000   8399.000000
mean   29965.179783       25.571735   1775.878179     0.049671    181.184423
std    17260.883447       14.481071   3585.050525     0.031823   1196.653372
min        3.000000        1.000000      2.240000     0.000000 -14140.700000
25%    15011.500000       13.000000    143.195000     0.020000    -83.315000
50%    29857.000000       26.000000    449.420000     0.050000     -1.500000
75%    44596.000000       38.000000   1709.320000     0.080000    162.750000
max    59973.000000       50.000000  89061.050000     0.250000  27220.690000

        Unit Price  Shipping Cost  Product Base Margin
count  8399.000000    8399.000000          8336.000000
mean     89.346259      12.838557             0.512513
std     290.354383      17.264052             0.135589
min       0.990000       0.490000             0.350000
25%       6.480000       3.300000             0.380000
50%      20.990000       6.070000             0.520000
75%      85.990000      13.990000             0.590000
max    6783.020000     164.730000             0.850000
</pre></div></div>
</div>
</div>
<div class="section" id="Extract-values-by-row-and-column">
<h3>Extract values by row and column<a class="headerlink" href="#Extract-values-by-row-and-column" title="Permalink to this headline">¶</a></h3>
<p>Once a DataFrame is populated we can access its content. Several options are available:</p>
<ol class="arabic simple">
<li><p>Select by column <code class="docutils literal notranslate"><span class="pre">DataFrame[col]</span></code> returns a Series</p></li>
<li><p>Select by row label <code class="docutils literal notranslate"><span class="pre">DataFrame.loc[row_label]</span></code> returns a Series</p></li>
<li><p>Select row by integer location <code class="docutils literal notranslate"><span class="pre">DataFrame.iloc[row_position]</span></code> returns a Series</p></li>
<li><p>Slice rows <code class="docutils literal notranslate"><span class="pre">DataFrame[S:E]</span></code> (S and E are labels, both included) returns a DataFrame</p></li>
<li><p>Select rows by boolean vector <code class="docutils literal notranslate"><span class="pre">DataFrame[bool_vect]</span></code> returns a DataFrame</p></li>
</ol>
<p><strong>Note that if names are well formed (i.e. no spaces, no strange characters…</strong>) we can use DataFrame.col instead of DataFrame[col]. Here are some ways to extract data from the orders dataframe:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/sampledata_orders.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Order Quantity column (top 5)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="s2">&quot;Order Quantity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Sales column (top 10)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">Sales</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The row with ID:50&quot;</span><span class="p">)</span>
<span class="n">r50</span> <span class="o">=</span> <span class="n">orders</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The third row:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Order Quantity, Sales, Discount and Profit of the 2nd,4th, 6th and 8th row:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">2</span><span class="p">][[</span><span class="s2">&quot;Order Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Discount&quot;</span><span class="p">,</span> <span class="s2">&quot;Profit&quot;</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Order Quantity, Sales, Discount and  Profit of orders with discount &gt; 10%:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="n">orders</span><span class="p">[</span><span class="s2">&quot;Discount&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">][[</span><span class="s2">&quot;Order Quantity&quot;</span><span class="p">,</span> <span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Discount&quot;</span><span class="p">,</span> <span class="s2">&quot;Profit&quot;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The Order Quantity column (top 5)
Row ID
1      6
49    49
50    27
80    30
85    19
Name: Order Quantity, dtype: int64

The Sales column (top 10)
Row ID
1        261.5400
49     10123.0200
50       244.5700
80      4965.7595
85       394.2700
86       146.6900
97        93.5400
98       905.0800
103     2781.8200
107      228.4100
Name: Sales, dtype: float64

The row with ID:50
Order ID                                                             293
Order Date                                                     10/1/2012
Order Priority                                                      High
Order Quantity                                                        27
Sales                                                             244.57
Discount                                                            0.01
Ship Mode                                                    Regular Air
Profit                                                             46.71
Unit Price                                                          8.69
Shipping Cost                                                       2.99
Customer Name                                               Barry French
Province                                                         Nunavut
Region                                                           Nunavut
Customer Segment                                                Consumer
Product Category                                         Office Supplies
Product Sub-Category                      Binders and Binder Accessories
Product Name            Cardinal Slant-D® Ring Binder, Heavy Gauge Vinyl
Product Container                                              Small Box
Product Base Margin                                                 0.39
Ship Date                                                      10/3/2012
Name: 50, dtype: object

The third row:
Order ID                                         483
Order Date                                 7/10/2011
Order Priority                                  High
Order Quantity                                    30
Sales                                        4965.76
Discount                                        0.08
Ship Mode                                Regular Air
Profit                                       1198.97
Unit Price                                    195.99
Shipping Cost                                   3.99
Customer Name                          Clay Rozendal
Province                                     Nunavut
Region                                       Nunavut
Customer Segment                           Corporate
Product Category                          Technology
Product Sub-Category    Telephones and Communication
Product Name                                    R380
Product Container                          Small Box
Product Base Margin                             0.58
Ship Date                                  7/12/2011
Name: 80, dtype: object
The Order Quantity, Sales, Discount and Profit of the 2nd,4th, 6th and 8th row:
        Order Quantity       Sales  Discount   Profit
Row ID
49                  49  10123.0200      0.07   457.81
80                  30   4965.7595      0.08  1198.97
86                  21    146.6900      0.05     4.43
98                  22    905.0800      0.09   127.70
The Order Quantity, Sales, Discount and  Profit of orders with discount &gt; 10%:
        Order Quantity    Sales  Discount  Profit
Row ID
176                 11  663.784      0.25 -481.04
3721                22  338.520      0.21  -17.75
37                  43  586.110      0.11   98.44
2234                 1   27.960      0.17   -9.13
4900                49  651.900      0.16  -74.51
</pre></div></div>
</div>
</div>
<div class="section" id="Broadcasting,-filtering-and-computing-stats">
<h3>Broadcasting, filtering and computing stats<a class="headerlink" href="#Broadcasting,-filtering-and-computing-stats" title="Permalink to this headline">¶</a></h3>
<p>These work pretty much like on Series and pandas takes care of adding NaNs when it cannot perform some operations due to missing values and so on.</p>
<p>Obviously some operators, when applied to entire tables, might not always make sense (like mean or sum of strings).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/sampledata_orders.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">orders_10</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Profit&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">orders_5</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Profit&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">orders_20</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Profit&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders_20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1">#Summing over the entries, does not make sense but...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top10 + Top5:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders_10</span> <span class="o">+</span> <span class="n">orders_5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="n">prod_cost</span> <span class="o">=</span> <span class="n">orders_20</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">orders_20</span><span class="p">[</span><span class="s2">&quot;Profit&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prod_cost</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Technology orders&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders_20</span><span class="p">[</span><span class="n">orders_20</span><span class="p">[</span><span class="s2">&quot;Product Category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Technology&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Office Supplies positive profit&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders_20</span><span class="p">[</span> <span class="p">(</span><span class="n">orders_20</span><span class="p">[</span><span class="s2">&quot;Product Category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Office Supplies&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">orders_20</span><span class="p">[</span><span class="s2">&quot;Profit&quot;</span><span class="p">]</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
             Sales   Profit Product Category
Row ID
1         261.5400  -213.25  Office Supplies
49      10123.0200   457.81  Office Supplies
50        244.5700    46.71  Office Supplies
80       4965.7595  1198.97       Technology
85        394.2700    30.94  Office Supplies
86        146.6900     4.43        Furniture
97         93.5400   -54.04  Office Supplies
98        905.0800   127.70  Office Supplies
103      2781.8200  -695.26  Office Supplies
107       228.4100  -226.36  Office Supplies
127       196.8500  -166.85  Office Supplies
128       124.5600   -14.33  Office Supplies
134       716.8400   134.72  Office Supplies
135      1474.3300   114.46       Technology
149        80.6100    -4.72  Office Supplies
160      1815.4900   782.91        Furniture
161       248.2600    93.80  Office Supplies
175      4462.2300   440.72        Furniture
176       663.7840  -481.04        Furniture
203       834.9040   -11.68       Technology

Top10 + Top5:
            Sales   Profit                Product Category
Row ID
1         523.080  -426.50  Office SuppliesOffice Supplies
49      20246.040   915.62  Office SuppliesOffice Supplies
50        489.140    93.42  Office SuppliesOffice Supplies
80       9931.519  2397.94            TechnologyTechnology
85        788.540    61.88  Office SuppliesOffice Supplies
86            NaN      NaN                             NaN
97            NaN      NaN                             NaN
98            NaN      NaN                             NaN
103           NaN      NaN                             NaN
107           NaN      NaN                             NaN

Row ID
1       474.7900
49     9665.2100
50      197.8600
80     3766.7895
85      363.3300
86      142.2600
97      147.5800
98      777.3800
103    3477.0800
107     454.7700
127     363.7000
128     138.8900
134     582.1200
135    1359.8700
149      85.3300
160    1032.5800
161     154.4600
175    4021.5100
176    1144.8240
203     846.5840
dtype: float64

Technology orders
            Sales   Profit Product Category
Row ID
80      4965.7595  1198.97       Technology
135     1474.3300   114.46       Technology
203      834.9040   -11.68       Technology

Office Supplies positive profit
           Sales  Profit Product Category
Row ID
49      10123.02  457.81  Office Supplies
50        244.57   46.71  Office Supplies
85        394.27   30.94  Office Supplies
98        905.08  127.70  Office Supplies
134       716.84  134.72  Office Supplies
161       248.26   93.80  Office Supplies
</pre></div></div>
</div>
<p>Statistics can be computed by <strong>column</strong> (normally the default) or by <strong>row</strong> (specifying <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>) or on the <strong>entire table</strong>.</p>
<p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/version/0.20/api.html#api-dataframe-stats">Here</a> you can find the complete list of methods that can be applied.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/random.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Global description&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let&#39;s reduce A in [0,1]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Let&#39;s reduce first row in [0,1]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean and std values (by column)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean and std values (by column) - top 10 values&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cumulative sum (by column)- top 10 rows&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cumulative sum (by row) - top 10 rows&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Global description
               A          B           C          D           E          F  \
count  50.000000  50.000000   50.000000  50.000000   50.000000  50.000000
mean   45.240000  49.760000   54.120000  50.500000   57.860000  49.180000
std    28.393417  32.193015   25.165282  28.321226   32.443364  28.488229
min     0.000000   0.000000    5.000000   1.000000    2.000000   1.000000
25%    21.750000  18.000000   35.750000  28.250000   29.250000  25.000000
50%    42.000000  49.500000   52.500000  49.500000   68.000000  52.000000
75%    63.250000  76.250000   73.750000  76.000000   86.750000  75.500000
max    99.000000  99.000000  100.000000  95.000000  100.000000  97.000000

                G         H          I           L
count   50.000000  50.00000  50.000000   50.000000
mean    49.780000  47.78000  46.920000   51.780000
std     29.673248  29.75978  31.056788   30.613649
min      1.000000   1.00000   0.000000    3.000000
25%     26.500000  24.50000  19.000000   26.250000
50%     51.000000  42.50000  44.000000   46.500000
75%     76.750000  72.00000  73.000000   82.000000
max    100.000000  99.00000  98.000000  100.000000

     A   B    C   D    E   F    G   H   I    L
0   28  69    5  41   12  62   90  32  33   85
1   91  59   64  94    4  51   45  52  96    5
2   54  74   53  92   20  84   85  21  98   73
3   99   0   39  12   90  15   62  38   4   67
4   98  10   35  77   46  97   88  72  15   37
5   44   9   91  57   98  63   52  77  62    7
6   76  17   12  41   69  34  100  29   0   91
7   52  25   43  59   87  91    1  90  23   90
8   56  33   38  91   13   1   34  17  22   82
9   29  18   42  48   34  16   64   7  46    9
10  81  77   38  93   63  90   57  58  52  100
11  57  97   23  59   38  93   46  49  88   86
12  57   0   79  78  100  76   16  31  79    8
13  18   1   67  44    2  17   53  51   6   23
14  77  95   94  88    9  25   54  23  36   35
15  87  42   63  33   95  53   11  58  53    3
16  34  24   24  28   74  79   86  98  42   90
17   1  31   20  63   70   3   29  39   5   87
18  35  17   77  15    9  63   86  95  95   21
19   0  85   13  13   60  74   44  78   7   56
20  61  20   47  21   85  78   53  14  37   70
21  81  15   89  54   38  59   72  35  59   12
22  20  81   76  15   64  18    9  47  11   81
23  57  94   73  19   21  79   81  45  71   40
24   2  58   83  67   99  46   76  70  50   45
25  64  13   52  60   32  70   32   4  73   20
26  27  49  100  48   70  30   58  48  42   36
27  82  89   93  73   30  64   18  54  93   82
28  19  85   98   7   84  71   77  20  18   63
29  34  95   68  23   68  38   73   1  28   10
30  33  60   66  80   94  41   53  99  29   57
31   0  99   18   2   29  28   11  30  36   56
32  20  61   33  89   52  59   50  55   4   33
33  82  72   41  33   92  16   18  99  73   91
34   8  28   22  29   83  53   47  10  42   34
35  64  50   24  59    6  83   92  91  87   98
36  42  73   50  17   91   9   39  37  97   50
37  27  49   67  61   21  25   94  96  16   98
38  44  44   48  70   86  85    9  31   4   46
39  36  93   64   1   96  89   14  75  10   84
40  20  13   34  87   11  10    2   5  91   27
41  54   2   61  80   98  53   96  40   2   26
42  42  88   79  31   41  23   50  95  77   26
43   7  14   56  95   70  28   78  31  34   95
44  40  65   34  44   97  36    3  90  55   13
45  97  61   45  32   91  26   84  33  57   80
46  60  49   47  92   81  51    7  18  66   47
47  39  98   90  33   68   5   26  72  76   37
48   6  18   74  51   77  19   28  21  81   46
49  20  69   54  26   25  80   36   8  65   31

Let&#39;s reduce A in [0,1]
0     0.282828
1     0.919192
2     0.545455
3     1.000000
4     0.989899
5     0.444444
6     0.767677
7     0.525253
8     0.565657
9     0.292929
10    0.818182
11    0.575758
12    0.575758
13    0.181818
14    0.777778
15    0.878788
16    0.343434
17    0.010101
18    0.353535
19    0.000000
20    0.616162
21    0.818182
22    0.202020
23    0.575758
24    0.020202
25    0.646465
26    0.272727
27    0.828283
28    0.191919
29    0.343434
30    0.333333
31    0.000000
32    0.202020
33    0.828283
34    0.080808
35    0.646465
36    0.424242
37    0.272727
38    0.444444
39    0.363636
40    0.202020
41    0.545455
42    0.424242
43    0.070707
44    0.404040
45    0.979798
46    0.606061
47    0.393939
48    0.060606
49    0.202020
Name: A, dtype: float64
Let&#39;s reduce first row in [0,1]
A    0.311111
B    0.766667
C    0.055556
D    0.455556
E    0.133333
F    0.688889
G    1.000000
H    0.355556
I    0.366667
L    0.944444
Name: 0, dtype: float64
Mean and std values (by column)
A    45.24
B    49.76
C    54.12
D    50.50
E    57.86
F    49.18
G    49.78
H    47.78
I    46.92
L    51.78
dtype: float64
A    28.393417
B    32.193015
C    25.165282
D    28.321226
E    32.443364
F    28.488229
G    29.673248
H    29.759780
I    31.056788
L    30.613649
dtype: float64

Mean and std values (by column) - top 10 values
0    45.7
1    56.1
2    65.4
3    42.6
4    57.5
5    56.0
6    46.9
7    56.1
8    38.7
9    31.3
dtype: float64
0    29.424291
1    33.013297
2    27.785688
3    35.647035
4    33.069792
5    30.342489
6    34.853503
7    32.942543
8    29.431842
9    18.826990
dtype: float64
Cumulative sum (by column)- top 10 rows
     A    B    C    D    E    F    G    H    I    L
0   28   69    5   41   12   62   90   32   33   85
1  119  128   69  135   16  113  135   84  129   90
2  173  202  122  227   36  197  220  105  227  163
3  272  202  161  239  126  212  282  143  231  230
4  370  212  196  316  172  309  370  215  246  267
5  414  221  287  373  270  372  422  292  308  274
6  490  238  299  414  339  406  522  321  308  365
7  542  263  342  473  426  497  523  411  331  455
8  598  296  380  564  439  498  557  428  353  537
9  627  314  422  612  473  514  621  435  399  546
Cumulative sum (by row) - top 10 rows
    A    B    C    D    E    F    G    H    I    L
0  28   97  102  143  155  217  307  339  372  457
1  91  150  214  308  312  363  408  460  556  561
2  54  128  181  273  293  377  462  483  581  654
3  99   99  138  150  240  255  317  355  359  426
4  98  108  143  220  266  363  451  523  538  575
5  44   53  144  201  299  362  414  491  553  560
6  76   93  105  146  215  249  349  378  378  469
7  52   77  120  179  266  357  358  448  471  561
8  56   89  127  218  231  232  266  283  305  387
9  29   47   89  137  171  187  251  258  304  313
</pre></div></div>
</div>
</div>
<div class="section" id="Merging-DataFrames">
<h3>Merging DataFrames<a class="headerlink" href="#Merging-DataFrames" title="Permalink to this headline">¶</a></h3>
<p>It is possible to merge together DataFrames having a common column name. The merge can be done with the pandas <code class="docutils literal notranslate"><span class="pre">merge</span></code> method. Upon merging, the two tables will be concatenated into a bigger one containing information from both DataFrames. The basic syntax is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pandas.merge(DataFrame1, DataFrame2, on=&quot;col_name&quot;, how=&quot;inner/outer/left/right&quot;)
</pre></div>
</div>
<p>The column on which the merge has to be performed is specified with the parameter <code class="docutils literal notranslate"><span class="pre">on</span></code> followed by the column name, while the behaviour of the merging depends on the parameter <code class="docutils literal notranslate"><span class="pre">how</span></code> that tells pandas how to behave when dealing with non-matching data. In particular:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. how = inner : non-matching entries are discarded;
2. how = left : ids are taken from the first DataFrame;
3. how = right : ids are taken from the second DataFrame;
4. how = outer : ids from both are retained.
</pre></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">Snp1</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;SNP_FB_0411211&quot;</span><span class="p">,</span><span class="s2">&quot;SNP_FB_0412425&quot;</span><span class="p">,</span><span class="s2">&quot;SNP_FB_0942385&quot;</span><span class="p">,</span>
               <span class="s2">&quot;CH01f09&quot;</span><span class="p">,</span><span class="s2">&quot;Hi05f12x&quot;</span><span class="p">,</span><span class="s2">&quot;SNP_FB_0942712&quot;</span> <span class="p">],</span>
        <span class="s2">&quot;type&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;SNP&quot;</span><span class="p">,</span><span class="s2">&quot;SNP&quot;</span><span class="p">,</span><span class="s2">&quot;SNP&quot;</span><span class="p">,</span><span class="s2">&quot;SSR&quot;</span><span class="p">,</span><span class="s2">&quot;SSR&quot;</span><span class="p">,</span><span class="s2">&quot;SNP&quot;</span><span class="p">]</span>
       <span class="p">}</span>
<span class="n">Snp2</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;SNP_FB_0411211&quot;</span><span class="p">,</span><span class="s2">&quot;SNP_FB_0412425&quot;</span><span class="p">,</span>
                <span class="s2">&quot;SNP_FB_0942385&quot;</span><span class="p">,</span> <span class="s2">&quot;CH01f09&quot;</span><span class="p">,</span><span class="s2">&quot;SNP_FB_0428218&quot;</span> <span class="p">],</span>
      <span class="s2">&quot;chr&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">,</span><span class="s2">&quot;7&quot;</span><span class="p">,</span><span class="s2">&quot;9&quot;</span><span class="p">,</span><span class="s2">&quot;1&quot;</span><span class="p">]</span>
     <span class="p">}</span>

<span class="n">DFs1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Snp1</span><span class="p">)</span>
<span class="n">DFs2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">Snp2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">DFs1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DFs2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inner merge (only common in both)&quot;</span><span class="p">)</span>
<span class="n">inJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DFs1</span><span class="p">,</span><span class="n">DFs2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inJ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left merge (IDS from DFs1)&quot;</span><span class="p">)</span>
<span class="n">leftJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DFs1</span><span class="p">,</span><span class="n">DFs2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">leftJ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right merge (IDS from DFs2)&quot;</span><span class="p">)</span>
<span class="n">rightJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DFs1</span><span class="p">,</span><span class="n">DFs2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rightJ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outer merge (IDS from both)&quot;</span><span class="p">)</span>
<span class="n">outJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DFs1</span><span class="p">,</span><span class="n">DFs2</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outJ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
               id type
0  SNP_FB_0411211  SNP
1  SNP_FB_0412425  SNP
2  SNP_FB_0942385  SNP
3         CH01f09  SSR
4        Hi05f12x  SSR
5  SNP_FB_0942712  SNP
               id chr
0  SNP_FB_0411211   1
1  SNP_FB_0412425  15
2  SNP_FB_0942385   7
3         CH01f09   9
4  SNP_FB_0428218   1

Inner merge (only common in both)
               id type chr
0  SNP_FB_0411211  SNP   1
1  SNP_FB_0412425  SNP  15
2  SNP_FB_0942385  SNP   7
3         CH01f09  SSR   9

Left merge (IDS from DFs1)
               id type  chr
0  SNP_FB_0411211  SNP    1
1  SNP_FB_0412425  SNP   15
2  SNP_FB_0942385  SNP    7
3         CH01f09  SSR    9
4        Hi05f12x  SSR  NaN
5  SNP_FB_0942712  SNP  NaN

Right merge (IDS from DFs2)
               id type chr
0  SNP_FB_0411211  SNP   1
1  SNP_FB_0412425  SNP  15
2  SNP_FB_0942385  SNP   7
3         CH01f09  SSR   9
4  SNP_FB_0428218  NaN   1

Outer merge (IDS from both)
               id type  chr
0  SNP_FB_0411211  SNP    1
1  SNP_FB_0412425  SNP   15
2  SNP_FB_0942385  SNP    7
3         CH01f09  SSR    9
4        Hi05f12x  SSR  NaN
5  SNP_FB_0942712  SNP  NaN
6  SNP_FB_0428218  NaN    1
</pre></div></div>
</div>
<p>Note that the columns we merge on do not necessarily need to be the same, we can specify a correspondence between the row of the first dataframe (the one on the left) and the second dataframe (the one on the right) specifying which columns must have the same values to perform the merge. This can be done by using the parameters <code class="docutils literal notranslate"><span class="pre">right_on</span> <span class="pre">=</span> <span class="pre">column_name</span></code> and <code class="docutils literal notranslate"><span class="pre">left_on</span> <span class="pre">=</span> <span class="pre">column_name</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#%reset -s -f</span>
<span class="o">%</span><span class="k">clear</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="s2">&quot;A&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">13</span><span class="p">]})</span>
<span class="n">d2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="s2">&quot;E&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">],</span> <span class="s2">&quot;F&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">DF2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>

<span class="n">merged_onBE</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DF2</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="n">merged_onAF</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">DF2</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DF2:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">inner merge on BE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_onBE</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">outer merge on AF:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_onAF</span><span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DF:
   A   B
0  1   3
1  2   4
2  3  73
3  4  13
DF2:
    E   F
0   1   3
1   4   1
2   3  71
3  13   1

inner merge on BE
   A   B   E   F
0  1   3   3  71
1  2   4   4   1
2  4  13  13   1

outer merge on AF:
     A     B     E     F
0  1.0   3.0   4.0   1.0
1  1.0   3.0  13.0   1.0
2  2.0   4.0   NaN   NaN
3  3.0  73.0   1.0   3.0
4  4.0  13.0   NaN   NaN
5  NaN   NaN   3.0  71.0
</pre></div></div>
</div>
</div>
<div class="section" id="Grouping">
<h3>Grouping<a class="headerlink" href="#Grouping" title="Permalink to this headline">¶</a></h3>
<p>Given a DataFrame, it is possible to apply the so called <strong>split-apply-aggregate</strong> processing method. Basically, this helps to group the data according to the value of some columns, apply a function on the different groups and aggregate the results in a new DataFrame.</p>
<p>Grouping of a DataFrame can be done by using the <strong>DataFrame.groupby(columnName)</strong> method which returns a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrameGroupBy</span></code> object, which basically is composed of two information: the <strong>name</strong> shared by each group and a <strong>DataFrame</strong> containing all the elements belonging to that group.</p>
<p>Given a grouped DataFrame, each group can be obtained with the <strong>get_group(groupName)</strong> it is also possible to loop over the groups:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for groupName, groupDataFrame in grouped:
    #do something
</pre></div>
</div>
<p>It is also possible to aggregate the groups by applying some functions to each of them (please refer to the <a class="reference external" href="http://pandas.pydata.org/pandas-docs/version/0.20/api.html#api-dataframe-stats">documentation</a>).</p>
<p>Let’s see these things in action.</p>
<p><strong>Example</strong> Given a list of labels and integers group them by label and compute the mean of all values in each group.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">test</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span> <span class="p">],</span>
        <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
       <span class="p">}</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">gDF</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="n">gDF</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Group: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>

<span class="n">aggDF</span> <span class="o">=</span> <span class="n">gDF</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">aggDF</span><span class="p">)</span>

<span class="c1">#without looping through the groups...</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The &#39;a&#39; group:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gDF</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The &#39;c&#39; group:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gDF</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">))</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   x   y
0  a   2
1  a   4
2  b   0
3  b   5
4  c   5
5  c  10

Group:  a
   x  y
0  a  2
1  a  4
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Group:  b
   x  y
2  b  0
3  b  5
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Group:  c
   x   y
4  c   5
5  c  10
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
     y
x
a  3.0
b  2.5
c  7.5

The &#39;a&#39; group:
   x  y
0  a  2
1  a  4

The &#39;c&#39; group:
   x   y
4  c   5
5  c  10
</pre></div></div>
</div>
<p><strong>Example</strong> Given the orders data seen above, let’s get the columns “Sales”, “Profit” and “Product Category” and compute the total sum and the mean of the sales and profits for each product category.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/sampledata_orders.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
                     <span class="n">index_col</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">SPC</span> <span class="o">=</span> <span class="n">orders</span><span class="p">[[</span><span class="s2">&quot;Sales&quot;</span><span class="p">,</span><span class="s2">&quot;Profit&quot;</span><span class="p">,</span> <span class="s2">&quot;Product Category&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">SPC</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">SPC</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">SPC</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Product Category&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Group: &quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Count elements per category:&quot;</span><span class="p">)</span> <span class="c1">#get the series corresponding to the column</span>
                                      <span class="c1">#and apply the value_counts() method</span>
<span class="nb">print</span><span class="p">(</span><span class="n">orders</span><span class="p">[</span><span class="s2">&quot;Product Category&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">sum</span><span class="p">)[[</span><span class="s2">&quot;Sales&quot;</span><span class="p">]])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean values (sorted by profit):&quot;</span><span class="p">)</span>
<span class="n">mv_sorted</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Profit&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mv_sorted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The most profitable is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mv_sorted</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
             Sales   Profit Product Category
Row ID
1         261.5400  -213.25  Office Supplies
49      10123.0200   457.81  Office Supplies
50        244.5700    46.71  Office Supplies
80       4965.7595  1198.97       Technology
85        394.2700    30.94  Office Supplies
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_43_1.png" src="_images/M1_practical8_43_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Group:  Furniture
Group:  Office Supplies
Group:  Technology

Count elements per category:
Office Supplies    4610
Technology         2065
Furniture          1724
Name: Product Category, dtype: int64

Total values:
                        Sales
Product Category
Furniture         5178590.542
Office Supplies   3752762.100
Technology        5984248.182
Mean values (sorted by profit):
                        Sales      Profit
Product Category
Furniture         3003.822820   68.116607
Office Supplies    814.048178  112.369072
Technology        2897.941008  429.207516

The most profitable is Technology
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Exercises">
<h2>Exercises<a class="headerlink" href="#Exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>The file <a class="reference external" href="file_samples/top_3000_words.txt">top_3000_words.txt</a> is a one-column file representing the top 3000 English words. Read the file and for each letter, count how many words start with that letter. Store this information in a dictionary. Create a pandas series from the dictionary and plot an histogram of all initials counting more than 100 words starting with them.</p></li>
</ol>
<div class="tggle" onclick="toggleVisibility(&#39;ex0&#39;);"><p>Show/Hide Solution</p>
</div><div id="ex0" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">readFile</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">initials</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">init</span> <span class="ow">in</span> <span class="n">initials</span><span class="p">:</span>
            <span class="n">initials</span><span class="p">[</span><span class="n">init</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initials</span><span class="p">[</span><span class="n">init</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">initials</span>



<span class="k">def</span> <span class="nf">filter_and_plot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">minCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1">#if you want to see the content of the series uncomment:</span>
    <span class="c1">#print(series)</span>
    <span class="n">filt_series</span> <span class="o">=</span> <span class="n">series</span><span class="p">[</span><span class="n">series</span> <span class="o">&gt;</span> <span class="n">minCount</span><span class="p">]</span>
    <span class="n">filt_series</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">inFile</span> <span class="o">=</span> <span class="s2">&quot;file_samples/top_3000_words.txt&quot;</span>

<span class="n">myDict</span> <span class="o">=</span> <span class="n">readFile</span><span class="p">(</span><span class="n">inFile</span><span class="p">)</span>
<span class="n">filter_and_plot</span><span class="p">(</span><span class="n">myDict</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>



<span class="sd">&quot;&quot;&quot;Solution 2 with DataFrame&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">readFile2</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
    <span class="c1">#print(data)</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">filter_and_plot2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">minCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">]</span> <span class="c1">#rename the column</span>
    <span class="c1">#Had to use lambda functions...</span>
    <span class="c1">#ex. lambda x : x + 1</span>
    <span class="c1">#check:</span>
    <span class="c1">#https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html</span>
    <span class="c1">#axis = 1 means we apply the function on all raws.</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;words&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1">#uncomment to see the data</span>
    <span class="c1">#print(data)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="c1">#An histogram!</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
    <span class="c1">#uncomment to see the final data</span>
    <span class="c1">#print(d)</span>
    <span class="n">filt_data</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">d</span> <span class="o">&gt;</span> <span class="n">minCount</span><span class="p">]</span>
    <span class="n">filt_data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----- Second solution -----&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------------&quot;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">readFile2</span><span class="p">(</span><span class="n">inFile</span><span class="p">)</span>
<span class="n">filter_and_plot2</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_46_0.png" src="_images/M1_practical8_46_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
---------------------------
----- Second solution -----
---------------------------
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_46_2.png" src="_images/M1_practical8_46_2.png" />
</div>
</div>
</div><ol class="arabic simple" start="2">
<li><p>The file <a class="reference external" href="file_samples/filt_aligns.tsv">filt_aligns.tsv</a> is a tab separated value file representing alignments of paired-end reads on some apple chromosomes. Paired end reads have the property of being X bases apart from each other as they have been sequenced from the two ends of some size-selected DNA molecules.</p></li>
</ol>
<img alt="iex2" src="_images/pe.png" />
<p>Each line of the file has the following information <code class="docutils literal notranslate"><span class="pre">readID\tChrPE1\tAlignmentPosition1\tChrPE2\tAlignmentPosition2</span></code>. The two ends of the same pair have the same readID. Load the read pairs aligning on the same chromosome into two dictionaries. The first (<code class="docutils literal notranslate"><span class="pre">inserts</span></code>) having readID as keys and the insert size (i.e. the absolute value of AlignmentPosition1 - AlignmentPosition2) as value. The second dictionary (<code class="docutils literal notranslate"><span class="pre">chrs</span></code>)will have readID as key and chromosome ID as value. Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>readID Chr11 31120 Chr11 31472
readID1 Chr7 12000 Chr11 11680
</pre></div>
</div>
<p>will result in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>inserts = {&quot;readID&quot; : 352, &quot;readID1&quot; : 320}
chrs = {&quot;readID&quot; : &quot;Chr11&quot;, &quot;readID1&quot; : &quot;Chr7&quot;}
</pre></div>
</div>
<p>Once you have the two dictionaries:</p>
<ol class="arabic simple">
<li><p>Create a Series with all the insert sizes and show some of its stats with the method <strong>describe</strong>. What is the mean insert size? How many paried end are we using to create this distribution?</p></li>
<li><p>Display the first 5 values of the series</p></li>
<li><p>Make a box plot to assess the distribution of the values.</p></li>
<li><p>Make an histogram to see the values in a different way. How does this distribution look like?</p></li>
<li><p>Create another series from the chromosome info and print the first 10 elements</p></li>
<li><p>Create a DataFrame starting from the two Series and print the first 10 elements</p></li>
<li><p>For each chromosome, get the average insert size of the paired aligned to it (hint:use group by).</p></li>
<li><p>Make a box plot of the average insert size per chromosome.</p></li>
</ol>
<div class="tggle" onclick="toggleVisibility(&#39;ex1&#39;);"><p>Show/Hide Solution</p>
</div><div id="ex1" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1">#Open the file and store the entries in the two dicts</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;file_samples/filt_aligns.tsv&quot;</span><span class="p">)</span>
<span class="n">inserts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">chrs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">infos</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">infos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">infos</span><span class="p">[</span><span class="mi">3</span><span class="p">]):</span>
        <span class="n">inserts</span><span class="p">[</span><span class="n">infos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">infos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">infos</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="n">chrs</span><span class="p">[</span><span class="n">infos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">infos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># or infos[3], they are the same!</span>
<span class="c1">#Inserts series</span>
<span class="n">inSeries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">inserts</span><span class="p">)</span>
<span class="n">descr</span> <span class="o">=</span> <span class="n">inSeries</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">descr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean insert size:&quot;</span><span class="p">,</span> <span class="n">descr</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">])</span>
<span class="c1">#Question 2</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First five elements:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inSeries</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="c1">#Question 3</span>
<span class="n">inSeries</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#Question 4</span>
<span class="n">inSeries</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#Question 5</span>
<span class="c1">#Chromosomes series</span>
<span class="n">chrSeries</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">chrs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chrSeries</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1">#Question 6</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;inserts&quot;</span><span class="p">:</span> <span class="n">inSeries</span><span class="p">,</span><span class="s2">&quot;chrs&quot;</span> <span class="p">:</span> <span class="n">chrSeries</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="c1">#Question 7</span>
<span class="n">grouped</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;chrs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average insert size by Chr:&quot;</span><span class="p">)</span>
<span class="n">ins_by_chr</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
<span class="c1">#Question 8</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ins_by_chr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
count    246499.000000
mean        194.126950
std          70.277551
min           0.000000
25%         150.000000
50%         189.000000
75%         232.000000
max         605.000000
dtype: float64

Mean insert size: 194.1269498050702

First five elements:
HWI-ST1296:74:C3FU9ACXX:7:2314:5661:3000    132
HWI-ST1296:74:C3FU9ACXX:6:2108:3151:3000    284
HWI-ST1296:75:C3F7CACXX:2:2302:4462:4000    294
HWI-ST1296:75:C3F7CACXX:1:1107:4328:4000      4
HWI-ST1296:75:C3F7CACXX:6:1205:3248:5000     69
dtype: int64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_49_1.png" src="_images/M1_practical8_49_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_49_2.png" src="_images/M1_practical8_49_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
HWI-ST1296:74:C3FU9ACXX:7:2314:5661:3000     Chr5
HWI-ST1296:74:C3FU9ACXX:6:2108:3151:3000     Chr3
HWI-ST1296:75:C3F7CACXX:2:2302:4462:4000    Chr11
HWI-ST1296:75:C3F7CACXX:1:1107:4328:4000    Chr13
HWI-ST1296:75:C3F7CACXX:6:1205:3248:5000    Chr11
HWI-ST1296:67:C2F0FACXX:6:2305:7251:7000     Chr6
HWI-ST1296:75:C3F7CACXX:6:1203:5851:3100    Chr13
HWI-ST1296:75:C3F7CACXX:4:2309:3769:8000    Chr14
HWI-ST1296:75:C3F7CACXX:4:1212:5969:8000     Chr6
HWI-ST1296:74:C3FU9ACXX:2:2215:1855:8000     Chr4
dtype: object
                                          inserts   chrs
HWI-ST1296:74:C3FU9ACXX:7:2314:5661:3000      132   Chr5
HWI-ST1296:74:C3FU9ACXX:6:2108:3151:3000      284   Chr3
HWI-ST1296:75:C3F7CACXX:2:2302:4462:4000      294  Chr11
HWI-ST1296:75:C3F7CACXX:1:1107:4328:4000        4  Chr13
HWI-ST1296:75:C3F7CACXX:6:1205:3248:5000       69  Chr11
HWI-ST1296:67:C2F0FACXX:6:2305:7251:7000      142   Chr6
HWI-ST1296:75:C3F7CACXX:6:1203:5851:3100      197  Chr13
HWI-ST1296:75:C3F7CACXX:4:2309:3769:8000      298  Chr14
HWI-ST1296:75:C3F7CACXX:4:1212:5969:8000      369   Chr6
HWI-ST1296:74:C3FU9ACXX:2:2215:1855:8000      519   Chr4
Average insert size by Chr:
          inserts
chrs
Chr1   195.351513
Chr10  193.678891
Chr11  194.374923
Chr12  193.983594
Chr13  192.804249
Chr14  194.400139
Chr15  194.937928
Chr16  193.533066
Chr17  194.559222
Chr2   193.905932
Chr3   193.937721
Chr4   193.858397
Chr5   195.052776
Chr6   194.336027
Chr7   193.766347
Chr8   194.482513
Chr9   193.195012
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_49_4.png" src="_images/M1_practical8_49_4.png" />
</div>
</div>
</div><ol class="arabic simple" start="3">
<li><p>Download the <a class="reference external" href="file_samples/train.csv">train.csv</a> dataset. As the name says it is a .csv file. The file contains information regarding loans given or refused to applicants. Information on the gender, marital status, education, work and income of the applicant is reported alongside the amount and length of the loan and credit history (i.e. 0 if no previous loan was given, 1 otherwise). Open it in a text editor or excel and inspect it first. Then, answer the following questions (if you have
any doubts check <a class="reference external" href="http://pandas.pydata.org/pandas-docs/version/0.20/api.html">here</a>):</p>
<ol class="arabic simple" start="0">
<li><p>Load it into a pandas DataFrame (use column <code class="docutils literal notranslate"><span class="pre">Loan_ID</span></code> as index. Hint: use parm index_col).</p></li>
<li><p>Get an idea of the data by visualizing its first 5 entries;</p></li>
<li><p>How many total entries are present in the file? How many males and females?</p></li>
<li><p>What is the average applicant income? Does the gender affect the income? Compute the average of the applicant income on the whole dataset and the average of the data grouped by Gender. How many Females have an income &gt; than the average?</p></li>
<li><p>How many loans have been given (i.e. Loan_Status equals Y)? What is the percentage of the loans given and that of the loans refused?</p></li>
<li><p>What is the percentage of given/refused loans in the case of married people?</p></li>
<li><p>What is the percentage of given/refused loans in the case of applicants with positive credit history (i.e. Credit_History equals 1)?</p></li>
</ol>
</li>
</ol>
<div class="tggle" onclick="toggleVisibility(&#39;ex2&#39;);"><p>Show/Hide Solution</p>
</div><div id="ex2" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/train.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s2">&quot;Loan_ID&quot;</span><span class="p">)</span>
<span class="c1">#Question 1:</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="c1">#Question 2:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">entries</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The toal number of entries is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">entries</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Males and Females&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="c1">#Question 3:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">avgIncome</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;ApplicantIncome&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The average income is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgIncome</span><span class="p">))</span>
<span class="n">train</span><span class="p">[[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span> <span class="s2">&quot;ApplicantIncome&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Gender&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">train</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="s2">&quot;ApplicantIncome&quot;</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s2">&quot;Gender&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">females</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Female&quot;</span><span class="p">]</span>
<span class="n">fhi</span> <span class="o">=</span> <span class="n">females</span><span class="p">[</span><span class="n">females</span><span class="p">[</span><span class="s2">&quot;ApplicantIncome&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">avgIncome</span><span class="p">][[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span><span class="s2">&quot;ApplicantIncome&quot;</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Female applicants with income higher than avg (</span><span class="si">{}</span><span class="s2">): </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avgIncome</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">fhi</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fhi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Question 4:</span>
<span class="n">loanSt</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;Loan_Status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of given loans is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loanSt</span><span class="p">[</span><span class="s2">&quot;Y&quot;</span><span class="p">]))</span>
<span class="c1">#loanSt is a Series, I can apply operator broadcasting on it</span>
<span class="c1">#to get the percentage</span>
<span class="n">loanSt</span> <span class="o">=</span> <span class="n">loanSt</span> <span class="o">/</span> <span class="n">entries</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The percentage of loans is the following&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loanSt</span><span class="p">)</span>

<span class="c1">#Question 5:</span>
<span class="n">loanSt</span> <span class="o">=</span>  <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Married&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">][</span><span class="s2">&quot;Loan_Status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">married</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;Married&quot;</span><span class="p">][</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Married&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">married</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The percentage of loans to married people (</span><span class="si">{}</span><span class="s2"> applicants)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">married</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loanSt</span><span class="o">/</span><span class="n">married</span><span class="p">)</span>

<span class="c1">#Question 6:</span>
<span class="n">loanSt</span> <span class="o">=</span>  <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Credit_History&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">][</span><span class="s2">&quot;Loan_Status&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">chist</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s2">&quot;Credit_History&quot;</span><span class="p">][</span><span class="n">train</span><span class="p">[</span><span class="s2">&quot;Credit_History&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">chist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The percentage of loans to applicants with credit history (</span><span class="si">{}</span><span class="s2"> applicants)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chist</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">loanSt</span><span class="o">/</span><span class="n">chist</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         Gender Married Dependents     Education Self_Employed  \
Loan_ID
LP001002   Male      No          0      Graduate            No
LP001003   Male     Yes          1      Graduate            No
LP001005   Male     Yes          0      Graduate           Yes
LP001006   Male     Yes          0  Not Graduate            No
LP001008   Male      No          0      Graduate            No

          ApplicantIncome  CoapplicantIncome  LoanAmount  Loan_Amount_Term  \
Loan_ID
LP001002             5849                0.0         NaN             360.0
LP001003             4583             1508.0       128.0             360.0
LP001005             3000                0.0        66.0             360.0
LP001006             2583             2358.0       120.0             360.0
LP001008             6000                0.0       141.0             360.0

          Credit_History Property_Area Loan_Status
Loan_ID
LP001002             1.0         Urban           Y
LP001003             1.0         Rural           N
LP001005             1.0         Urban           Y
LP001006             1.0         Urban           Y
LP001008             1.0         Urban           Y

The toal number of entries is 614

Males and Females
Male      489
Female    112
Name: Gender, dtype: int64

The average income is 5403.459283387622
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.6/dist-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify &#39;dtype=object&#39; when creating the ndarray
  return array(a, dtype, copy=False, order=order)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_52_2.png" src="_images/M1_practical8_52_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Female applicants with income higher than avg (5403.459283387622): 21
          Gender  ApplicantIncome
Loan_ID
LP001186  Female            11500
LP001392  Female             7451
LP001422  Female            10408
LP001516  Female            14866
LP001519  Female            10000
LP001708  Female            10000
LP001776  Female             8333
LP001871  Female             7200
LP001945  Female             5417
LP002142  Female             5500
LP002194  Female            15759
LP002231  Female             6000
LP002301  Female             7441
LP002377  Female             8624
LP002393  Female            10047
LP002407  Female             7142
LP002582  Female            17263
LP002634  Female            13262
LP002731  Female            18165
LP002813  Female            19484
LP002959  Female            12000

The number of given loans is: 422

The percentage of loans is the following
Y    0.687296
N    0.312704
Name: Loan_Status, dtype: float64
398
The percentage of loans to married people (398 applicants)
Y    0.71608
N    0.28392
Name: Loan_Status, dtype: float64
475
The percentage of loans to applicants with credit history (475 applicants)
Y    0.795789
N    0.204211
Name: Loan_Status, dtype: float64
</pre></div></div>
</div>
</div><ol class="arabic simple" start="4">
<li><p>[Thanks to Stefano Teso] DNA transcription and translation into proteins follows this schema:</p></li>
</ol>
<img alt="iex4" src="_images/genestructure.jpg" />
<p>The file <a class="reference external" href="file_samples/gene_table.csv">gene_table.csv</a> is a comma separated value file representing a summary of the annotation of several human genes based on the <a class="reference external" href="http://www.ensembl.org/index.html">Ensembl</a> annotation. For each gene it contains the following information:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gene_name,gene_biotype,chromosome,strand,transcript_count
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">gene_name</span></code> is based on the <a class="reference external" href="http://www.genenames.org/">HGNC</a> nomenclature. <code class="docutils literal notranslate"><span class="pre">gene_biotype</span></code> represents the biotype (refer to <a class="reference external" href="http://vega.sanger.ac.uk/info/about/gene_and_transcript_types.html">VEGA</a> like protein_coding, pseudogene, lincRNA, miRNA etc. <code class="docutils literal notranslate"><span class="pre">chromosome</span></code> is where the feature is located, <code class="docutils literal notranslate"><span class="pre">strand</span></code> is a + or a - for the forward or reverse strand and <code class="docutils literal notranslate"><span class="pre">transcript_count</span></code> reports the number of isoforms of the gene.</p>
<p>A sample of the file follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>TSPAN6,protein_coding,chrX,-,5
TNMD,protein_coding,chrX,+,2
DPM1,protein_coding,chr20,-,6
SCYL3,protein_coding,chr1,-,5
C1orf112,protein_coding,chr1,+,9
FGR,protein_coding,chr1,-,7
CFH,protein_coding,chr1,+,6
FUCA2,protein_coding,chr6,-,3
GCLC,protein_coding,chr6,-,13
</pre></div>
</div>
<p>Write a python program that:</p>
<ol class="arabic simple" start="0">
<li><p>Loads the <a class="reference external" href="file_samples/gene_table.csv">gene_table.csv</a> in a DataFrame (inspect the first entries with head to check the content of the file);</p></li>
<li><p>Computes the number of genes annotated for the human genome;</p></li>
<li><p>Computes the minimum, maximum, average and median number of known isoforms per gene (consider the transcript_count column as a series).</p></li>
<li><p>Plots a histogram and a boxplot of the number of known isoforms per gene</p></li>
<li><p>Computes the number of different biotypes. How many genes do we have for each genotype? Plot the number of genes per biotype in a horizontal bar plot (hint: use also figsize = (10,10) to make it visible;</p></li>
<li><p>Computes the number of different chromosomes</p></li>
<li><p>Computes, for each chromosome, the number of genes it contains, and prints a horizontal barplot with the number of genes per chromosome.</p></li>
<li><p>Computes, for each chromosome, the percentage of genes located on the + strand</p></li>
<li><p>Computes, for each biotype, the average number of transcripts associated to genes belonging to the biotype. Finally, plots them in a vertical bar plot</p></li>
</ol>
<div class="tggle" onclick="toggleVisibility(&#39;ex3&#39;);"><p>Show/Hide Solution</p>
</div><div id="ex3" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">genes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file_samples/gene_table.csv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">genes</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Question 1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of genes: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">genes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1">#Question 2</span>
<span class="n">maxI</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">minI</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">avgI</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">medI</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Isoform per gene stats:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; - max: </span><span class="si">{}</span><span class="s2"> min </span><span class="si">{}</span><span class="s2"> avg </span><span class="si">{}</span><span class="s2"> median </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">maxI</span><span class="p">,</span> <span class="n">minI</span><span class="p">,</span><span class="n">avgI</span><span class="p">,</span><span class="n">medI</span><span class="p">))</span>

<span class="c1">#Question 3</span>
<span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;hist&quot;</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">genes</span><span class="p">[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;box&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="c1">#Question 4</span>
<span class="n">biot</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;gene_biotype&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The number of different biotypes is&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">biot</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">biot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">biot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;barh&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#Question 5</span>
<span class="n">chrs</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;chromosome&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The total number of chromosomes is &quot;</span><span class="p">,</span> <span class="n">chrs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#Question 6</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">chrs</span> <span class="o">=</span> <span class="n">genes</span><span class="p">[</span><span class="s2">&quot;chromosome&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">chrs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;barh&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Question 7</span>
<span class="c1">#Let&#39;s group the data by chromosome and strand</span>
<span class="c1">#then loop through all the elements to count the</span>
<span class="c1">#total elements per chromosome</span>
<span class="c1">#to compute the percentage of the ones that are on + strand</span>
<span class="c1">#The totals go on a dictionary with key chr</span>

<span class="n">grp_chrs</span> <span class="o">=</span> <span class="n">genes</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;chromosome&quot;</span><span class="p">,</span> <span class="s2">&quot;strand&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">grp_chrs</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">grp_chrs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}</span><span class="s2">) : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ind</span><span class="p">),</span> <span class="n">grp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

<span class="n">tot_byChr</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">grp_chrs</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">tot_byChr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">tot_byChr</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">grp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tot_byChr</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">grp</span> <span class="ow">in</span> <span class="n">grp_chrs</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">% g</span><span class="s2">enes of </span><span class="si">{}</span><span class="s2"> on strand +: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="o">*</span><span class="n">grp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">tot_byChr</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>



<span class="c1">#Question 8</span>
<span class="n">biot</span><span class="o">=</span> <span class="n">grp_chrs</span> <span class="o">=</span> <span class="n">genes</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;gene_biotype&quot;</span><span class="p">])</span>
<span class="n">biot_transc</span> <span class="o">=</span> <span class="n">biot</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">mean</span><span class="p">)[[</span><span class="s2">&quot;transcript_count&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">biot_transc</span><span class="p">)</span>

<span class="n">biot_transc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  gene_name    gene_biotype chromosome strand  transcript_count
0    TSPAN6  protein_coding       chrX      -                 5
1      TNMD  protein_coding       chrX      +                 2
2      DPM1  protein_coding      chr20      -                 6
3     SCYL3  protein_coding       chr1      -                 5
4  C1orf112  protein_coding       chr1      +                 9

Total number of genes: 51116

Isoform per gene stats:
 - max: 170 min 1 avg 3.7033218561702794 median 1.0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_56_1.png" src="_images/M1_practical8_56_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_56_2.png" src="_images/M1_practical8_56_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

The number of different biotypes is 41

protein_coding                        19297
processed_pseudogene                   9826
lincRNA                                6645
antisense                              5086
unprocessed_pseudogene                 2143
snRNA                                  1802
miRNA                                  1173
misc_RNA                                955
sense_intronic                          686
transcribed_unprocessed_pseudogene      660
rRNA                                    512
processed_transcript                    438
transcribed_processed_pseudogene        425
snoRNA                                  403
sense_overlapping                       174
IG_V_pseudogene                         173
unitary_pseudogene                      141
IG_V_gene                               130
TR_V_gene                                93
TR_J_gene                                71
transcribed_unitary_pseudogene           53
IG_D_gene                                33
TR_V_pseudogene                          30
polymorphic_pseudogene                   28
3prime_overlapping_ncRNA                 26
Mt_tRNA                                  22
IG_J_gene                                18
scaRNA                                   16
IG_C_gene                                14
IG_C_pseudogene                           9
TEC                                       6
TR_C_gene                                 5
ribozyme                                  5
TR_J_pseudogene                           4
TR_D_gene                                 3
IG_J_pseudogene                           3
pseudogene                                2
Mt_rRNA                                   2
bidirectional_promoter_lncRNA             2
vaultRNA                                  1
scRNA                                     1
Name: gene_biotype, dtype: int64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_56_4.png" src="_images/M1_practical8_56_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The total number of chromosomes is  25
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_56_6.png" src="_images/M1_practical8_56_6.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pandas.core.groupby.generic.DataFrameGroupBy
(&#39;chr1&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 2388
(&#39;chr1&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 2322
(&#39;chr10&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 999
(&#39;chr10&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 944
(&#39;chr11&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1470
(&#39;chr11&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1472
(&#39;chr12&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1262
(&#39;chr12&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1269
(&#39;chr13&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 537
(&#39;chr13&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 558
(&#39;chr14&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1029
(&#39;chr14&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 976
(&#39;chr15&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 901
(&#39;chr15&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 883
(&#39;chr16&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1077
(&#39;chr16&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1036
(&#39;chr17&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1227
(&#39;chr17&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1306
(&#39;chr18&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 508
(&#39;chr18&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 491
(&#39;chr19&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1361
(&#39;chr19&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1303
(&#39;chr2&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1803
(&#39;chr2&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1786
(&#39;chr20&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 577
(&#39;chr20&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 592
(&#39;chr21&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 297
(&#39;chr21&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 342
(&#39;chr22&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 585
(&#39;chr22&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 505
(&#39;chr3&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1345
(&#39;chr3&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1395
(&#39;chr4&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1152
(&#39;chr4&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1145
(&#39;chr5&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1303
(&#39;chr5&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1295
(&#39;chr6&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1222
(&#39;chr6&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1237
(&#39;chr7&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1320
(&#39;chr7&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1187
(&#39;chr8&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1039
(&#39;chr8&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1113
(&#39;chr9&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 989
(&#39;chr9&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 952
(&#39;chrMT&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 28
(&#39;chrMT&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 9
(&#39;chrX&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1078
(&#39;chrX&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 1031
(&#39;chrY&#39;, &#39;+&#39;)(&lt;class &#39;tuple&#39;&gt;) : 240
(&#39;chrY&#39;, &#39;-&#39;)(&lt;class &#39;tuple&#39;&gt;) : 230
{&#39;chr1&#39;: 4710, &#39;chr10&#39;: 1943, &#39;chr11&#39;: 2942, &#39;chr12&#39;: 2531, &#39;chr13&#39;: 1095, &#39;chr14&#39;: 2005, &#39;chr15&#39;: 1784, &#39;chr16&#39;: 2113, &#39;chr17&#39;: 2533, &#39;chr18&#39;: 999, &#39;chr19&#39;: 2664, &#39;chr2&#39;: 3589, &#39;chr20&#39;: 1169, &#39;chr21&#39;: 639, &#39;chr22&#39;: 1090, &#39;chr3&#39;: 2740, &#39;chr4&#39;: 2297, &#39;chr5&#39;: 2598, &#39;chr6&#39;: 2459, &#39;chr7&#39;: 2507, &#39;chr8&#39;: 2152, &#39;chr9&#39;: 1941, &#39;chrMT&#39;: 37, &#39;chrX&#39;: 2109, &#39;chrY&#39;: 470}
% genes of chr1 on strand +: 50.70
% genes of chr10 on strand +: 51.42
% genes of chr11 on strand +: 49.97
% genes of chr12 on strand +: 49.86
% genes of chr13 on strand +: 49.04
% genes of chr14 on strand +: 51.32
% genes of chr15 on strand +: 50.50
% genes of chr16 on strand +: 50.97
% genes of chr17 on strand +: 48.44
% genes of chr18 on strand +: 50.85
% genes of chr19 on strand +: 51.09
% genes of chr2 on strand +: 50.24
% genes of chr20 on strand +: 49.36
% genes of chr21 on strand +: 46.48
% genes of chr22 on strand +: 53.67
% genes of chr3 on strand +: 49.09
% genes of chr4 on strand +: 50.15
% genes of chr5 on strand +: 50.15
% genes of chr6 on strand +: 49.69
% genes of chr7 on strand +: 52.65
% genes of chr8 on strand +: 48.28
% genes of chr9 on strand +: 50.95
% genes of chrMT on strand +: 75.68
% genes of chrX on strand +: 51.11
% genes of chrY on strand +: 51.06
                                    transcript_count
gene_biotype
3prime_overlapping_ncRNA                    1.153846
IG_C_gene                                   1.285714
IG_C_pseudogene                             1.000000
IG_D_gene                                   1.000000
IG_J_gene                                   1.000000
IG_J_pseudogene                             1.000000
IG_V_gene                                   1.053846
IG_V_pseudogene                             1.000000
Mt_rRNA                                     1.000000
Mt_tRNA                                     1.000000
TEC                                         1.166667
TR_C_gene                                   1.800000
TR_D_gene                                   1.000000
TR_J_gene                                   1.000000
TR_J_pseudogene                             1.000000
TR_V_gene                                   1.010753
TR_V_pseudogene                             1.000000
antisense                                   1.870232
bidirectional_promoter_lncRNA               2.000000
lincRNA                                     1.690143
miRNA                                       1.000000
misc_RNA                                    1.000000
polymorphic_pseudogene                      3.285714
processed_pseudogene                        1.000204
processed_transcript                        5.844749
protein_coding                              7.447893
pseudogene                                  1.000000
rRNA                                        1.000000
ribozyme                                    1.000000
scRNA                                       1.000000
scaRNA                                      1.000000
sense_intronic                              1.087464
sense_overlapping                           1.609195
snRNA                                       1.000000
snoRNA                                      1.027295
transcribed_processed_pseudogene            2.101176
transcribed_unitary_pseudogene              5.056604
transcribed_unprocessed_pseudogene          3.339394
unitary_pseudogene                          1.921986
unprocessed_pseudogene                      1.000467
vaultRNA                                    1.000000
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_56_8.png" src="_images/M1_practical8_56_8.png" />
</div>
</div>
</div><ol class="arabic simple" start="5">
<li><p>Write a function that creates and returns a data frame having columns with the labels specified through a list taken in input and ten rows of random data between 1 and 100.</p>
<ol class="arabic simple">
<li><p>Create two random DataFrames one with labels l = [“A”, “B”, “C” ,“D”,“E”] and l1 = [“W”, “X”,“Y”,“Z”]</p></li>
<li><p>Print the first 5 elements to inspect the two DataFrames and plot the valuse of the two DataFrames;</p></li>
<li><p>Create a new Series S1 with values: [1, 1, 1, 0, 0, 1, 1, 0, 0, 1]. Get the Series corresponding to the column “C” and multiply it point-to-point by the Series S1 (hint use: Series.multiply(S1))</p></li>
<li><p>Add this new series as a “C” column of the second DataFrame.</p></li>
<li><p>Merge the two DataFrames based on the value of C. Perform an inner, outer, left and right merge and see the difference</p></li>
</ol>
</li>
</ol>
<div class="tggle" onclick="toggleVisibility(&#39;ex4&#39;);"><p>Show/Hide Solution</p>
</div><div id="ex4" style="display:none;"><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">createRandomDF</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; returns a random dataframe with columns having names equal to the</span>
<span class="sd">    input labels&quot;&quot;&quot;</span>
    <span class="n">tmp_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">tmp_dict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">tmp_dict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

    <span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">tmp_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">DF</span>

<span class="c1">#Question 1</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span> <span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">]</span>
<span class="n">l1</span> <span class="o">=</span> <span class="p">[</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">createRandomDF</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">createRandomDF</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>

<span class="c1">#Question 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">df1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#Question 3</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">Sc</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">Sc</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>

<span class="c1">#Question 4</span>
<span class="n">df1</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="c1">#Question 5</span>
<span class="n">inJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inner Join DF - DF1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inJ</span><span class="p">)</span>
<span class="n">outJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outer Join DF - DF1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outJ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Left Join DF - DF1&quot;</span><span class="p">)</span>
<span class="n">lJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lJ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Right Join DF - DF1&quot;</span><span class="p">)</span>
<span class="n">rJ</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">df1</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rJ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
   A  B  C  D  E
0  1  5  7  8  5
1  7  5  1  2  4
2  2  2  7  7  0
3  2  4  3  4  6
4  4  2  5  9  9

   W   X   Y  Z
0  7  10   6  0
1  3   4   5  1
2  9   1   8  1
3  9  10   1  1
4  8   2  10  0
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_59_1.png" src="_images/M1_practical8_59_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/M1_practical8_59_2.png" src="_images/M1_practical8_59_2.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    7
1    1
2    7
3    0
4    0
5    4
6    8
7    0
8    0
9    1
dtype: int64
   W   X   Y  Z  C
0  7  10   6  0  7
1  3   4   5  1  1
2  9   1   8  1  7
3  9  10   1  1  0
4  8   2  10  0  0
5  9   3   3  3  4
6  0   6   7  3  8
7  2   4   0  7  0
8  7   1   8  6  0
9  1   8   0  8  1
   A  B  C  D   E
0  1  5  7  8   5
1  7  5  1  2   4
2  2  2  7  7   0
3  2  4  3  4   6
4  4  2  5  9   9
5  0  1  4  4   4
6  6  2  8  7   8
7  3  8  0  0  10
8  0  3  2  1   0
9  1  5  1  7   3

Inner Join DF - DF1
    A  B  C  D   E  W   X   Y  Z
0   1  5  7  8   5  7  10   6  0
1   1  5  7  8   5  9   1   8  1
2   2  2  7  7   0  7  10   6  0
3   2  2  7  7   0  9   1   8  1
4   7  5  1  2   4  3   4   5  1
5   7  5  1  2   4  1   8   0  8
6   1  5  1  7   3  3   4   5  1
7   1  5  1  7   3  1   8   0  8
8   0  1  4  4   4  9   3   3  3
9   6  2  8  7   8  0   6   7  3
10  3  8  0  0  10  9  10   1  1
11  3  8  0  0  10  8   2  10  0
12  3  8  0  0  10  2   4   0  7
13  3  8  0  0  10  7   1   8  6

Outer Join DF - DF1
    A  B  C  D   E    W     X     Y    Z
0   1  5  7  8   5  7.0  10.0   6.0  0.0
1   1  5  7  8   5  9.0   1.0   8.0  1.0
2   2  2  7  7   0  7.0  10.0   6.0  0.0
3   2  2  7  7   0  9.0   1.0   8.0  1.0
4   7  5  1  2   4  3.0   4.0   5.0  1.0
5   7  5  1  2   4  1.0   8.0   0.0  8.0
6   1  5  1  7   3  3.0   4.0   5.0  1.0
7   1  5  1  7   3  1.0   8.0   0.0  8.0
8   2  4  3  4   6  NaN   NaN   NaN  NaN
9   4  2  5  9   9  NaN   NaN   NaN  NaN
10  0  1  4  4   4  9.0   3.0   3.0  3.0
11  6  2  8  7   8  0.0   6.0   7.0  3.0
12  3  8  0  0  10  9.0  10.0   1.0  1.0
13  3  8  0  0  10  8.0   2.0  10.0  0.0
14  3  8  0  0  10  2.0   4.0   0.0  7.0
15  3  8  0  0  10  7.0   1.0   8.0  6.0
16  0  3  2  1   0  NaN   NaN   NaN  NaN

Left Join DF - DF1
    A  B  C  D   E    W     X     Y    Z
0   1  5  7  8   5  7.0  10.0   6.0  0.0
1   1  5  7  8   5  9.0   1.0   8.0  1.0
2   7  5  1  2   4  3.0   4.0   5.0  1.0
3   7  5  1  2   4  1.0   8.0   0.0  8.0
4   2  2  7  7   0  7.0  10.0   6.0  0.0
5   2  2  7  7   0  9.0   1.0   8.0  1.0
6   2  4  3  4   6  NaN   NaN   NaN  NaN
7   4  2  5  9   9  NaN   NaN   NaN  NaN
8   0  1  4  4   4  9.0   3.0   3.0  3.0
9   6  2  8  7   8  0.0   6.0   7.0  3.0
10  3  8  0  0  10  9.0  10.0   1.0  1.0
11  3  8  0  0  10  8.0   2.0  10.0  0.0
12  3  8  0  0  10  2.0   4.0   0.0  7.0
13  3  8  0  0  10  7.0   1.0   8.0  6.0
14  0  3  2  1   0  NaN   NaN   NaN  NaN
15  1  5  1  7   3  3.0   4.0   5.0  1.0
16  1  5  1  7   3  1.0   8.0   0.0  8.0

Right Join DF - DF1
    A  B  C  D   E  W   X   Y  Z
0   1  5  7  8   5  7  10   6  0
1   2  2  7  7   0  7  10   6  0
2   1  5  7  8   5  9   1   8  1
3   2  2  7  7   0  9   1   8  1
4   7  5  1  2   4  3   4   5  1
5   1  5  1  7   3  3   4   5  1
6   7  5  1  2   4  1   8   0  8
7   1  5  1  7   3  1   8   0  8
8   3  8  0  0  10  9  10   1  1
9   3  8  0  0  10  8   2  10  0
10  3  8  0  0  10  2   4   0  7
11  3  8  0  0  10  7   1   8  6
12  0  1  4  4   4  9   3   3  3
13  6  2  8  7   8  0   6   7  3
</pre></div></div>
</div>
</div></div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright # 2021 - 2021, Luca Marchetti

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>